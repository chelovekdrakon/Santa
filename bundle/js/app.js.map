{"version":3,"sources":["webpack:///webpack/bootstrap ca0fa1e7e3d6ea1334bc","webpack:///./src/Entity.js","webpack:///./src/math.js","webpack:///./src/Traits/Killable.js","webpack:///./src/spritesheet.js","webpack:///./src/Traits/Jump.js","webpack:///./src/Traits/Go.js","webpack:///./src/Traits/Physics.js","webpack:///./src/app.js","webpack:///./src/game-field.js","webpack:///./src/Sprite.js","webpack:///./src/TileCollider.js","webpack:///./src/TileResolver.js","webpack:///./src/BoundingBox.js","webpack:///./src/EntityCollider.js","webpack:///./src/animations.js","webpack:///./src/Camera.js","webpack:///./src/Font.js","webpack:///./src/loaders.js","webpack:///./src/entities.js","webpack:///./src/Entities/Cosmo.js","webpack:///./src/Traits/Stomper.js","webpack:///./src/Traits/ReachEdge.js","webpack:///./src/Traits/Falling.js","webpack:///./src/Traits/StateCosmo.js","webpack:///./src/Entities/Enemies.js","webpack:///./src/Traits/PendulumWalk.js","webpack:///./src/Entities/Artefacts.js","webpack:///./src/Traits/PlayerController.js","webpack:///./src/input.js","webpack:///./src/keyboardState.js","webpack:///./src/debug.js","webpack:///./src/timer.js","webpack:///./src/layers/collision.js","webpack:///./src/layers/background.js","webpack:///./src/layers/camera.js","webpack:///./src/layers/dashboard.js","webpack:///./style/css/style.css","webpack:///./style/scss/style.scss"],"names":["Sides","TOP","Symbol","BOTTOM","LEFT","RIGHT","Trait","constructor","name","NAME","obstruct","collides","us","them","update","Entity","pos","vel","size","offset","startPositin","lifetime","bounds","traits","player","addTrait","trait","push","side","forEach","candidate","deltaTime","sprites","Matrix","grid","get","x","y","col","undefined","set","value","Vect","Killable","dead","deadTime","removeAfter","kill","revive","entity","pictures","deadPic","entities","delete","Spritesheet","image","data","tiles","Map","camera","TILE_SIZE","define","buffers","map","flip","buffer","document","createElement","context","getContext","png","frame","width","height","scale","translate","includes","deltaX","deltaY","drawImage","draw","type","drawTiles","x1","x2","y1","y2","getEntitiesByName","Jump","duration","velocity","engageTime","ready","requestTime","gracePeriod","speedBoost","start","cancel","Math","abs","Go","dir","speed","acceleration","deceleration","dragFactor","distance","heading","maxSpeed","absX","decel","min","drag","Physics","countPatrol","distanceAll","pendulumWalk","deltaDistance","amplitudePatrol","positionBySinusoid","sin","PI","killable","tileCollider","checkX","checkY","gravity","canvas","getElementById","setAttribute","drawField","Promise","all","loadImage","loadJSON","then","tileImage","tileData","layout","fontData","fontsData","sprite","font","letter","drawBackgroundLayer","drawBackground","drawCollisions","createCollisionLayer","drawCameraView","createCameraLayer","cosmo","createEntities","dashboard","createDashboardLayer","timer","getByName","Sprite","Set","tilesMatrix","entityCollider","drawEntity","drawCosmo","frames","runAnim","createAnimation","routeFrame","jump","go","max","picture","check","TileCollider","tileLayout","right","tileSize","matrix","length","left","matches","searchByRange","top","bottom","match","reachEdge","stepToEdge","nextTile","TileResolver","toIndex","floor","toIndexRange","pos1","pos2","pMax","ceil","range","getByIndex","indexX","indexY","tile","searchByPosition","posX","posY","BoundingBox","overlaps","box","EntityCollider","frameLen","resolveFrame","frameIndex","frameName","Camera","Font","print","text","sizeX","sizeY","index","url","resolve","Image","addEventListener","src","fetch","response","json","createEnemy","createEnemiesFactory","createArtefact","createArtefactsFactory","species","velX","velY","positions","reverse","offsetX","offsetY","artefacts","artef","arrPositions","createCosmo","createCosmoFactory","createPlayerEnv","input","setupKeyboard","setupMouseControl","listenTo","window","playerEntity","playerControl","checkPoint","SLOW_DRAG","FAST_DRAG","setTurboState","turtleOn","setTurtleState","turboOn","add","turboAndSlow","slowAndTurbo","Stomper","queueBounce","bounceSpeed","bounce","ReachEdge","Falling","currentX","stateCosmo","alive","playerController","death","time","StateCosmo","lives","coins","keys","locks","opebedLocks","Behavior","enemy","console","log","stomper","sequence","Array","from","PendulumWalk","randomForPatrol","random","artefact","PlayerController","stopTime","has","addMapping","keyState","PRESSED","RELEASED","KeyboardState","keyStates","keyMap","code","callback","handleEvent","event","preventDefault","eventName","lastEvent","buttons","Timer","lastTime","accumulatedTime","updateProxy","enqueue","requestAnimationFrame","drawEntityBox","drawBoundingBoxes","strokeStyle","beginPath","rect","stroke","createTileCandidateLayer","resolvedTiles","tileResolver","getByIndexOriginal","getByIndexFake","call","drawTileCandidates","bufferContext","backgrounds","xLen","cameraToDraw","drawCameraRect","fromCamera","drawDashboard","round","fillStyle","fillText","strokeText"],"mappings":"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","file":"bundle/js/app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ca0fa1e7e3d6ea1334bc","import {Vect} from './math';\r\nimport BoundingBox from './BoundingBox.js';\r\n\r\nexport const Sides = {\r\n        TOP: Symbol('top'),\r\n        BOTTOM: Symbol('bottom'),\r\n        LEFT: Symbol('left'),\r\n        RIGHT: Symbol('right'),\r\n    };\r\n\r\nexport class Trait {\r\n    constructor(name) {\r\n        this.NAME = name;\r\n    }\r\n\r\n    obstruct() {\r\n\r\n    }\r\n\r\n    collides(us, them) {\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n    }\r\n}\r\n\r\nexport default class Entity {\r\n    constructor(name) {\r\n        this.name = name;\r\n        this.pos = new Vect(0,0);\r\n        this.vel = new Vect(0,0);\r\n        this.size = new Vect(0,0);\r\n        this.offset = new Vect(0,0);\r\n        this.startPositin = new Vect(0,0);\r\n\r\n        this.lifetime = 0;\r\n        this.bounds = new BoundingBox(this.pos, this.size, this.offset);\r\n\r\n        this.traits = [];\r\n\r\n        this.player = false;\r\n    }\r\n\r\n    addTrait(trait) {\r\n        this.traits.push(trait);\r\n        this[trait.NAME] = trait;\r\n    }\r\n\r\n    obstruct(side) {\r\n        this.traits.forEach( trait => {\r\n            trait.obstruct(this, side);\r\n        });\r\n    }\r\n\r\n    collides(candidate) {\r\n        this.traits.forEach( trait => {\r\n            trait.collides(this, candidate);\r\n        });\r\n    }\r\n\r\n    update(deltaTime, sprites) {\r\n        this.traits.forEach( trait => {\r\n            trait.update(this, deltaTime, sprites);\r\n        })\r\n\r\n        this.lifetime += deltaTime;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Entity.js","export class Matrix {\r\n    constructor() {\r\n        this.grid = [];\r\n    }\r\n\r\n    get(x,y) {\r\n        const col = this.grid[x];\r\n        if (col) {\r\n            return col[y];\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    set(x, y, value) {\r\n        if (!this.grid[x]) {\r\n            this.grid[x] = [];\r\n        }\r\n\r\n        this.grid[x][y] = value;\r\n    }\r\n}\r\n\r\nexport class Vect {\r\n    constructor(x, y) {\r\n        this.set(x,y);\r\n    }\r\n    set(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/math.js","import {Sides, Trait} from '../Entity';\r\n\r\nexport default class Killable extends Trait {\r\n    constructor() {\r\n        super('killable');\r\n        this.dead = false;\r\n        this.deadTime = 0;\r\n        this.removeAfter = 2;\r\n    }\r\n\r\n    kill(){\r\n        this.dead = true;\r\n    }\r\n\r\n    revive () {\r\n        this.dead = false;\r\n        this.deadTime = 0;\r\n    }\r\n\r\n    update(entity, deltaTime, sprites) {\r\n        if (this.dead) {\r\n            if (!entity.player) {\r\n                entity.pictures = entity.deadPic;\r\n            } else {\r\n                sprites.entities.delete(entity);\r\n            }\r\n\r\n\r\n            if (entity.name === 'purple') {\r\n                entity.offset.y = -180;\r\n            } else if (entity.name === 'green') {\r\n                entity.offset.y = -62;\r\n            }\r\n\r\n            this.deadTime += deltaTime;\r\n\r\n            if (this.deadTime > this.removeAfter) {\r\n                sprites.entities.delete(entity);\r\n            }\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Killable.js","import Camera from './Camera';\r\n\r\nexport default class Spritesheet {\r\n    constructor(image, data) {\r\n        this.image = image;\r\n        this.data = data;\r\n        this.tiles = new Map();\r\n\r\n        this.camera = new Camera();\r\n        this.TILE_SIZE = 37;\r\n    }\r\n\r\n    define(name) {\r\n\r\n        const buffers = [false, true].map(flip => {\r\n            const buffer = document.createElement('canvas');\r\n            const context = buffer.getContext('2d');\r\n            const png = this.data[`${name}`].frame;\r\n            buffer.width = png['w'];\r\n            buffer.height = png['h'];\r\n\r\n            if (flip) {\r\n                context.scale(-1, 1);\r\n                context.translate(-buffer.width, 0);\r\n            }\r\n\r\n            if (png['w'] < this.TILE_SIZE && png['h'] < this.TILE_SIZE && !name.includes('enemy')) {\r\n                buffer.width = this.TILE_SIZE;\r\n                buffer.height = this.TILE_SIZE;\r\n                let deltaX = (this.TILE_SIZE - png['w'])/2;\r\n                let deltaY = (this.TILE_SIZE - png['h'])/2;\r\n                context.drawImage(this.image, png['x'], png['y'], png['w'], png['h'],\r\n                                               deltaX,  deltaY,   png['w'], png['h']);\r\n            } else {\r\n                context.drawImage(this.image, png['x'], png['y'], png['w'], png['h'],\r\n                                             0,         0,        png['w'], png['h']);\r\n            }\r\n            return buffer;\r\n        });\r\n        this.tiles.set(name, buffers);\r\n    }\r\n/* this method can be deleted? i don't know where we can use it  BUT may be it for fonts??? */\r\n    draw(name, context, x, y, type, flip) {\r\n        \r\n        const buffer = this.tiles.get(`${name}.png`)[flip ? 1 : 0];\r\n\r\n        x = x * buffer.width;\r\n        y = y * buffer.width;\r\n\r\n        context.drawImage(buffer, x - this.camera.pos.x, y - this.camera.pos.y);\r\n    }\r\n\r\n    drawTiles(name, context, type, x1, x2, y1, y2) {\r\n        for (let x = x1; x < x2; ++x) {\r\n            for (let y = y1; y < y2; ++y) {\r\n                this.draw(name, context, x, y, type);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    getEntitiesByName(name) {\r\n        let entities = [];\r\n        this.entities.forEach(value => {\r\n            if (value.name == name) {\r\n                entities.push(value);\r\n            }\r\n        });\r\n        return entities;\r\n    }\r\n\r\n    update(deltaTime, context) {\r\n\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/spritesheet.js","\r\nimport {Trait, Sides} from '../Entity';\r\n\r\n\r\nexport default class Jump extends Trait {\r\n    constructor() {\r\n        super('jump');\r\n\r\n        this.duration = 0.5;\r\n        this.velocity = 200;\r\n        this.engageTime = 0;\r\n\r\n        this.ready = 1;\r\n        this.requestTime = 0;\r\n        this.gracePeriod = 0.5;\r\n\r\n        this.speedBoost = 0.3;\r\n    }\r\n\r\n    start() {\r\n        this.requestTime = this.gracePeriod;\r\n    }\r\n\r\n    cancel() {\r\n        this.engageTime = 0;\r\n        this.requestTime = 0;\r\n    }\r\n\r\n    obstruct(entity, side) {\r\n\r\n        if (side === Sides.BOTTOM) {\r\n            this.ready = 1;\r\n        } else if (side === Sides.TOP) {\r\n\r\n            this.cancel();\r\n        }\r\n    }\r\n\r\n    update(entity, deltaTime) {\r\n        if (this.requestTime > 0) {\r\n            if (this.ready > 0) {\r\n                this.engageTime = this.duration;\r\n                this.requestTime = 0;\r\n            }\r\n            this.requestTime -= deltaTime;\r\n        }\r\n\r\n\r\n        if (this.engageTime > 0) {\r\n            entity.vel.y = -(this.velocity + Math.abs(entity.vel.x) * this.speedBoost);\r\n            this.engageTime -= deltaTime;\r\n        }\r\n\r\n        this.ready--;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Jump.js","import {Trait} from '../Entity';\r\n\r\nexport default class Go extends Trait {\r\n    constructor() {\r\n        super('go');\r\n        this.dir = 0;\r\n        this.speed = 12000;\r\n\r\n        this.acceleration = 500;\r\n        this.deceleration = 350;\r\n        this.dragFactor = 1/5000;\r\n\r\n        this.distance = 0;\r\n        this.heading = 1;\r\n    }\r\n\r\n    update(entity, deltaTime) {\r\n        const maxSpeed = this.speed * deltaTime * this.dir;\r\n        const absX = Math.abs(entity.vel.x);\r\n\r\n        if (this.dir !== 0) {\r\n                entity.vel.x += this.acceleration * deltaTime * this.dir;\r\n                this.heading = this.dir;\r\n\r\n            } else if (entity.vel.x !== 0) {\r\n                let decel = Math.min(absX, this.deceleration * deltaTime);\r\n                entity.vel.x += entity.vel.x > 0 ? -decel : decel;\r\n            } else {\r\n                this.distance = 0;\r\n            }\r\n\r\n        const drag = this.dragFactor * entity.vel.x * absX;\r\n        entity.vel.x -= drag;\r\n\r\n        this.distance += absX * deltaTime;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Go.js","import {Sides, Trait} from '../Entity.js';\r\n\r\nexport default class Physics extends Trait {\r\n    constructor() {\r\n        super('physics');\r\n\r\n        this.countPatrol = 0;\r\n    }\r\n\r\n    update(entity, deltaTime, sprites) {\r\n\r\n        if (entity.name.includes('black')) {\r\n\r\n            let distanceAll = Math.abs(entity.pendulumWalk.speed) * entity.lifetime;\r\n            let deltaDistance = distanceAll - this.countPatrol * entity.pendulumWalk.amplitudePatrol;\r\n            let positionBySinusoid = 1 - Math.sin(Math.PI * entity.lifetime)/15;\r\n\r\n            if (deltaDistance > entity.pendulumWalk.amplitudePatrol) {\r\n\r\n                this.countPatrol++;\r\n                entity.pendulumWalk.speed = -entity.pendulumWalk.speed;\r\n            }\r\n\r\n            if (!entity.killable.dead) {\r\n                entity.vel.y = 0;\r\n                entity.pos.y = entity.startPositin.y * positionBySinusoid;\r\n            }\r\n        }\r\n\r\n        entity.pos.x += entity.vel.x * deltaTime;\r\n        sprites.tileCollider.checkX(entity, sprites.camera);\r\n\r\n        entity.pos.y += entity.vel.y * deltaTime;\r\n        sprites.tileCollider.checkY(entity, sprites.camera);\r\n\r\n        entity.vel.y += sprites.gravity * deltaTime;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Physics.js","import drawField from './game-field';\r\n\r\nconst canvas = document.getElementById('canvas');\r\nconst context = canvas.getContext('2d');\r\n// canvas.setAttribute('width', `${window.devicePixelRatio}` * 960);\r\n// canvas.setAttribute('height', `${window.devicePixelRatio}` * 640);\r\n// canvas.style.width = `960px`;\r\n// canvas.style.height = `640px`;\r\n\r\ncanvas.setAttribute('width', 960);\r\ncanvas.setAttribute('height', 629);\r\n\r\ndrawField(context, canvas);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","import Sprite from './Sprite';\r\nimport Font from './Font';\r\nimport {loadImage,loadJSON} from './loaders';\r\nimport {createEntities} from './entities';\r\nimport Timer from './timer';\r\n\r\nimport createCollisionLayer from './layers/collision';\r\nimport drawBackground from './layers/background';\r\nimport createCameraLayer from './layers/camera';\r\nimport createDashboardLayer from './layers/dashboard';\r\n\r\nexport default function drawField(context, canvas) {\r\n    Promise.all([\r\n        loadImage('./images/sprites.png'),\r\n        loadJSON('./sprites'),\r\n        loadJSON('./levels/1-2'),\r\n        loadJSON('./alphabet'),\r\n        loadImage('./images/alphabet.png')\r\n    ])\r\n    .then(([tileImage, tileData, layout, fontData, fontsData]) => {\r\n\r\n\r\n        const sprites = new Sprite(tileImage, tileData);\r\n        for (let sprite in tileData) {\r\n            sprites.define(sprite);\r\n        }\r\n\r\n        const font = new Font(fontsData, fontData);\r\n\r\n        for (let letter in fontData) {\r\n            font.define(letter);\r\n        }\r\n\r\n        const drawBackgroundLayer = drawBackground(sprites, layout);\r\n\r\n        const drawCollisions = createCollisionLayer(sprites);\r\n        const drawCameraView = createCameraLayer(sprites.camera);\r\n\r\n        const cosmo = createEntities(sprites, layout);\r\n        const dashboard = createDashboardLayer(cosmo);\r\n\r\n\r\n        const timer = new Timer(1/60);\r\n        timer.update = function update(deltaTime) {\r\n\r\n                drawBackgroundLayer(context);\r\n                sprites.update(deltaTime, context);\r\n                // font.print('!@#$%*,', context, 0, 100, 90, 90);\r\n                // font.print('1234567890', context, 0, 200, 90, 90);\r\n                // font.print('QWERTYUIOP', context, 0, 300, 90, 90);\r\n                // font.print('ASDFGHJKL', context, 0, 400, 90, 90);\r\n                // font.print('ZXCVBNM', context, 0, 500, 90, 90);\r\n\r\n                drawCollisions(context, sprites.camera);\r\n                drawCameraView(context, sprites.camera);\r\n\r\n                dashboard(context);\r\n        }\r\n        timer.start();\r\n    });\r\n}\r\n\r\n\r\nfunction getByName(name) {\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/game-field.js","import {Matrix} from './math';\r\nimport TileCollider from './TileCollider';\r\nimport EntityCollider from './EntityCollider';\r\nimport {createAnimation} from './animations';\r\nimport Spritesheet from './spritesheet'\r\n\r\nexport default class Sprite extends Spritesheet {\r\n    constructor(image, data) {\r\n        super(image, data);\r\n\r\n        this.entities = new Set();\r\n        this.tilesMatrix = new Matrix();\r\n\r\n        this.tileCollider = new TileCollider(this.tilesMatrix);\r\n        this.entityCollider = new EntityCollider(this.entities);\r\n\r\n        this.gravity = 2000;\r\n    }\r\n\r\n    draw(name, context, x, y, type, flip) {\r\n\r\n\r\n        const buffer = this.tiles.get(`${name}.png`)[flip ? 1 : 0];\r\n\r\n        if (type) {\r\n            if (type !== 'decor') {\r\n                this.tilesMatrix.set(x, y, {\r\n                    'name': name,\r\n                    'type': type\r\n                });\r\n            }\r\n        if (name.includes('coin') || name.includes('key')) {\r\n                x = x * this.TILE_SIZE;\r\n                y = y * this.TILE_SIZE;\r\n            } else {\r\n                x = x * buffer.width;\r\n                y = y * buffer.height;\r\n            }\r\n        }\r\n\r\n        context.drawImage(buffer, x - this.camera.pos.x, y - this.camera.pos.y);\r\n    }\r\n\r\n    drawEntity (name, context, x, y, flip = false) {\r\n            const buffer = this.tiles.get(`${name}.png`)[flip ? 0 : 1];\r\n            context.drawImage(buffer, x - this.camera.pos.x, y - this.camera.pos.y);\r\n    }\r\n\r\n    drawCosmo(cosmo, context) {\r\n        let buffer;\r\n\r\n        let frames = ['boy4.png', 'boy3.png', 'boy2.png', 'boy1.png'];\r\n\r\n        let runAnim = createAnimation(frames, 5);\r\n\r\n        function routeFrame (cosmo) {\r\n            if (cosmo.jump.ready < 0) {\r\n                return 'boy3.png';\r\n            }\r\n            if (cosmo.go.distance > 0) {\r\n               return runAnim(cosmo.go.distance);\r\n            }\r\n            return 'boy1.png';\r\n        }\r\n\r\n        buffer = this.tiles.get(routeFrame (cosmo))[cosmo.go.heading > 0 ? 0 : 1];\r\n\r\n        context.drawImage(buffer, cosmo.pos.x - this.camera.pos.x,\r\n                                  cosmo.pos.y - this.camera.pos.y);\r\n    }\r\n\r\n    update(deltaTime, context) {\r\n        this.entities.forEach(entity => {\r\n            entity.update(deltaTime, this);\r\n\r\n            if (entity.name === 'cosmo') {\r\n                this.drawCosmo(entity, context);\r\n                this.camera.pos.x = entity.pos.x > 3040 ? 2740 : Math.max(0, entity.pos.x - 300);\r\n\r\n            } else if (entity.name.includes('key') || entity.name.includes('coin') || entity.name.includes('lock')) {\r\n                this.draw(entity.name, context, entity.pos.x , entity.pos.y )\r\n\r\n            } else if (entity.name !== 'cosmo') {\r\n                this.drawEntity(entity.picture, context, entity.pos.x, entity.pos.y, entity.pendulumWalk.speed > 0 ? 0 : 1);\r\n            }\r\n        });\r\n\r\n        this.entities.forEach(entity => {\r\n            this.entityCollider.check(entity);\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Sprite.js","import TileResolver from './TileResolver';\r\nimport {Sides} from './Entity';\r\n\r\nexport default class TileCollider {\r\n    constructor(tileLayout) {\r\n        this.tiles = new TileResolver(tileLayout);\r\n    }\r\n\r\n    checkX(entity, camera) {\r\n        if (entity.pos.x < 0 ) {\r\n            entity.pos.x = 0;\r\n        }\r\n         if (entity.bounds.right > this.tiles.tileSize * this.tiles.matrix.grid.length) {\r\n            entity.pos.x = this.tiles.tileSize * this.tiles.matrix.grid.length - entity.size.x;\r\n        }\r\n\r\n        let x;\r\n        if (entity.vel.x > 0) {    \r\n            x = entity.bounds.right;\r\n        } else if (entity.vel.x < 0) {\r\n            x = entity.bounds.left;\r\n        } else {\r\n            return;\r\n        }\r\n\r\n        const matches = this.tiles.searchByRange(x, x,\r\n                                                 entity.bounds.top,\r\n                                                 entity.bounds.bottom);\r\n\r\n        matches.forEach( match => {\r\n            if (entity.vel.x > 0) {\r\n                if (entity.bounds.right > match.x1) {\r\n                    entity.bounds.right = match.x1;\r\n                    entity.vel.x = 0;\r\n\r\n                    entity.obstruct(Sides.RIGHT);\r\n                }\r\n            } else if (entity.vel.x < 0) {\r\n                if (entity.bounds.left < match.x2) {\r\n                    entity.bounds.left = match.x2;\r\n                    entity.vel.x = 0;\r\n\r\n                    entity.obstruct(Sides.LEFT);\r\n                }\r\n\r\n            }\r\n        });\r\n    }\r\n\r\n    checkY(entity) {\r\n        let y;\r\n        if (entity.vel.y > 0) {\r\n            y = entity.bounds.bottom;\r\n        } else if (entity.vel.y < 0) {\r\n            y = entity.bounds.top;\r\n        } else {\r\n            return;\r\n        }\r\n\r\n        const matches = this.tiles.searchByRange(entity.bounds.left,\r\n                                                 entity.bounds.right,\r\n                                                 y, y);\r\n\r\n        matches.forEach( match => {\r\n            if (entity.vel.y > 0) {\r\n                if (entity.bounds.bottom > match.y1) {\r\n\r\n                    entity.bounds.bottom = match.y1;\r\n                    entity.vel.y = 0;\r\n\r\n                    this.reachEdge(entity, y);\r\n\r\n                    entity.obstruct(Sides.BOTTOM);\r\n\r\n                }\r\n            } else if (entity.vel.y < 0) {\r\n                if (entity.bounds.top < match.y2) {\r\n                    entity.bounds.top = match.y2;\r\n                    entity.vel.y = 0;\r\n                    entity.obstruct(Sides.TOP);\r\n                }\r\n\r\n            }\r\n        });\r\n    }\r\n\r\n    reachEdge(entity, y) {\r\n        if (!entity.player) {\r\n\r\n            let stepToEdge = entity.size.x * Math.abs(entity.vel.x)/entity.vel.x;    \r\n            stepToEdge = stepToEdge ? stepToEdge : 0;  \r\n            let nextTile = this.tiles.searchByRange(entity.bounds.left + stepToEdge,\r\n                                                    entity.bounds.right + stepToEdge,\r\n                                                    y, y)[0];\r\n            if (!nextTile) {\r\n                entity.pendulumWalk.speed = -entity.pendulumWalk.speed;\r\n            }\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/TileCollider.js","// World position -> to tile indexes\r\nexport default class TileResolver {\r\n    constructor(matrix, tileSize = 37) {\r\n        this.matrix = matrix;\r\n        this.tileSize = tileSize;\r\n    }\r\n\r\n    toIndex(pos) {\r\n        return Math.floor(pos / this.tileSize);\r\n    }\r\n\r\n    toIndexRange(pos1, pos2) {\r\n        const pMax = Math.ceil(pos2 / this.tileSize) * this.tileSize;\r\n        const range = [];\r\n        let pos = pos1;\r\n        do {\r\n            range.push(this.toIndex(pos));\r\n            pos += this.tileSize;\r\n        } while (pos < pMax);\r\n        return range;\r\n    }\r\n\r\n    getByIndex(indexX, indexY) {\r\n        const tile = this.matrix.get(indexX, indexY);\r\n        if (tile) {\r\n            const x1 = indexX * this.tileSize;\r\n            const x2 = x1 + this.tileSize;\r\n\r\n            const y1 = indexY * this.tileSize;\r\n            const y2 = y1 + this.tileSize;\r\n            return {\r\n                tile,\r\n                x1,\r\n                x2,\r\n                y1,\r\n                y2\r\n            }\r\n        }\r\n    }\r\n\r\n    \r\n\r\n    searchByPosition(posX, posY) {\r\n        return this.getByIndex(\r\n            this.toIndex(posX),\r\n            this.toIndex(posY));\r\n    }\r\n\r\n    searchByRange(x1, x2, y1, y2) {\r\n        const matches = [];\r\n\r\n        this.toIndexRange(x1, x2).forEach(indexX => {\r\n            this.toIndexRange(y1, y2).forEach(indexY => {\r\n                const match = this.getByIndex(indexX, indexY);\r\n                if (match) {\r\n                    matches.push(match);\r\n                }\r\n            });\r\n        });\r\n\r\n        return matches;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/TileResolver.js","export default class BoundingBox {\r\n    constructor(pos, size, offset) {\r\n        this.pos = pos;\r\n        this.size = size;\r\n        this.offset = offset;\r\n    }\r\n\r\n    overlaps(box) {\r\n        return this.bottom > box.top\r\n            && this.top < box.bottom\r\n            && this.left < box.right\r\n            && this.right > box.left;\r\n    }\r\n\r\n    get bottom() {\r\n        return this.pos.y + this.size.y + this.offset.y;\r\n    }\r\n\r\n    set bottom(y) {\r\n        this.pos.y = y - (this.size.y + this.offset.y);\r\n    }\r\n\r\n    get top() {\r\n        return this.pos.y + this.offset.y;\r\n    }\r\n\r\n    set top(y) {\r\n        this.pos.y = y - this.offset.y;\r\n    }\r\n\r\n    get left() {\r\n        return this.pos.x + this.offset.x;\r\n    }\r\n\r\n    set left(x) {\r\n        this.pos.x = x - this.offset.x;\r\n    }\r\n\r\n    get right() {\r\n        return this.pos.x + this.size.x + this.offset.x;\r\n    }\r\n\r\n    set right(x) {\r\n        this.pos.x = x - (this.size.x + this.offset.x);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/BoundingBox.js","export default class EntityCollider {\r\n    constructor(entities) {\r\n        this.entities = entities;\r\n    }\r\n\r\n    check(entity) {\r\n        this.entities.forEach(candidate => {\r\n            if (entity === candidate) {\r\n                return;\r\n            }\r\n\r\n            if (entity.bounds.overlaps(candidate.bounds)){\r\n                entity.collides(candidate);\r\n                candidate.collides(entity);\r\n            }\r\n        })\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/EntityCollider.js","export\tfunction createAnimation(frames, frameLen) {\r\n\t\treturn function resolveFrame(distance) {\r\n\t\t\tlet frameIndex = Math.floor(distance / frameLen % frames.length);\r\n\t\t\tlet frameName = frames[frameIndex];\r\n\t\t\treturn frameName;\r\n\t\t}\r\n\t}\n\n\n// WEBPACK FOOTER //\n// ./src/animations.js","import {Vect} from './math';\r\n\r\nexport default class Camera {\r\n    constructor(){\r\n        this.pos = new Vect(0, 0);\r\n        this.size = new Vect(900, 629)\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Camera.js","import Spritesheet from './spritesheet'\r\n\r\nexport default class Font extends Spritesheet {\r\n    constructor(image,data) {\r\n        super(image, data);\r\n    }\r\n\r\n    print(text, context, x, y, sizeX, sizeY, flip) {\r\n        [...text].forEach( (letter, index) => {\r\n            const buffer = this.tiles.get(`${letter}.png`)[flip ? 1 : 0];\r\n\r\n            context.drawImage(buffer, x + index * sizeX, y, sizeX, sizeY);\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Font.js","export function loadImage(url) {\r\n    return new Promise( resolve => {\r\n        const image = new Image();\r\n        image.addEventListener('load', () => {\r\n            resolve(image);\r\n        });\r\n        image.src = url;\r\n    })\r\n}\r\n\r\nexport function loadJSON(name) {\r\n    return fetch(`./src/database/${name}.json`)\r\n    .then(response => response.json());\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/loaders.js","import {createCosmoFactory} from './Entities/Cosmo';\r\nimport {createEnemiesFactory} from './Entities/Enemies'\r\nimport {createArtefactsFactory} from './Entities/Artefacts'\r\n\r\nimport PlayerController from './Traits/PlayerController';\r\n\r\nimport setupKeyboard from './input';\r\nimport {setupMouseControl} from './debug';\r\n\r\nexport function createEntities(sprites, layout) {\r\n\r\n    const createEnemy = createEnemiesFactory(sprites);\r\n    const createArtefact = createArtefactsFactory(sprites);\r\n\r\n    layout.entities.forEach(species => {\r\n        const name = species.name;\r\n        const [sizeX, sizeY] = species.data.size;\r\n        const pictures = species.data.pictures;\r\n        const deadPic = species.data.deadPic;\r\n        const [velX, velY] = species.data.velocity;\r\n\r\n        species.positions.forEach(entity => {\r\n            const [posX, posY, reverse] = entity.pos;\r\n            const [offsetX, offsetY] = entity.offset;\r\n\r\n            createEnemy(name, posX, posY,\r\n                              offsetX, offsetY,\r\n                              sizeX, sizeY,\r\n                              velX, velY,\r\n                              reverse, pictures, deadPic);\r\n        });\r\n    });\r\n    \r\n    layout.artefacts.forEach(artef => {\r\n        const name = artef.name;\r\n        const pictures = artef.data.pictures;\r\n\r\n        artef.positions.forEach(arrPositions => {\r\n            const [posX, posY] = arrPositions;\r\n\r\n            createArtefact(name, posX, posY);\r\n        });\r\n    });\r\n\r\n\r\n    const createCosmo = createCosmoFactory(sprites);\r\n    const cosmo = createCosmo();\r\n\r\n    createPlayerEnv(cosmo);\r\n\r\n    const input = setupKeyboard(cosmo);\r\n    setupMouseControl(canvas, cosmo, sprites.camera);\r\n    input.listenTo(window);\r\n\r\n    return cosmo;\r\n}\r\n\r\nfunction createPlayerEnv (playerEntity) {\r\n    const playerControl = new PlayerController(playerEntity);\r\n    playerControl.checkPoint.set(42, 42);\r\n    playerEntity.addTrait(playerControl);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/entities.js","import Entity from '../Entity';\r\nimport Jump from '../Traits/Jump';\r\nimport Go from '../Traits/Go';\r\nimport Stomper from '../Traits/Stomper';\r\nimport Physics from '../Traits/Physics';\r\n\r\nimport Killable from '../Traits/Killable'\r\nimport ReachEdge from '../Traits/ReachEdge';\r\n\r\nimport Falling from '../Traits/Falling';\r\nimport StateCosmo from '../Traits/StateCosmo';\r\n\r\nconst SLOW_DRAG = 1/2000;\r\nconst FAST_DRAG = 1/5000;\r\n\r\nexport function createCosmoFactory(sprites) {\r\n\r\n    function setTurboState(turtleOn) {\r\n      this.go.dragFactor = turtleOn ? SLOW_DRAG : FAST_DRAG;\r\n    }\r\n\r\n    function setTurtleState(turboOn) {\r\n      this.go.dragFactor = turboOn ? FAST_DRAG : SLOW_DRAG;\r\n    }\r\n\r\n    return function createCosmo() {\r\n        const cosmo = new Entity('cosmo');\r\n\r\n        cosmo.player = true;\r\n\r\n        cosmo.size.set(20, 50);\r\n\r\n        cosmo.pos.set(185, 420);\r\n        cosmo.vel.set(0, -600);\r\n        cosmo.offset.set(9, 0);\r\n\r\n        sprites.entities.add(cosmo);\r\n\r\n        cosmo.addTrait(new Physics());\r\n        cosmo.addTrait(new Jump());\r\n        cosmo.addTrait(new Go());\r\n        cosmo.addTrait(new Stomper());\r\n        cosmo.addTrait(new Killable());\r\n\r\n        cosmo.addTrait(new Falling());\r\n        cosmo.addTrait(new StateCosmo());\r\n\r\n\r\n        cosmo.turboAndSlow = setTurboState;\r\n        cosmo.slowAndTurbo = setTurtleState;\r\n\r\n        return cosmo;\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Entities/Cosmo.js","import {Sides, Trait} from '../Entity.js';\r\n\r\nexport default class Stomper extends Trait {\r\n    constructor() {\r\n        super('stomper');\r\n        this.queueBounce = false;\r\n        this.bounceSpeed = 400;\r\n    }\r\n\r\n    bounce() {\r\n        this.queueBounce = true;\r\n    }\r\n\r\n    update(entity) {\r\n        if (this.queueBounce) {\r\n            entity.vel.y = -this.bounceSpeed;\r\n            this.queueBounce = false;\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Stomper.js","import {Trait} from '../Entity';\r\n\r\nexport default class ReachEdge extends Trait {\r\n    constructor() {\r\n        super('reachEdge');\r\n    }\r\n\r\n    update(entity, deltaTime, sprites) {\r\n        if (entity.pos.x < 0) {\r\n                // entity.pos.x = 1;\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/ReachEdge.js","import {Trait} from '../Entity';\r\n\r\nexport default class Falling extends Trait {\r\n    constructor() {\r\n        super('falling');\r\n    }\r\n\r\n    update(entity, deltaTime, sprites) {\r\n        let currentX = entity.pos.x;\r\n        if (entity.pos.y > 800 && entity.stateCosmo.alive) {\r\n            // entity.stateCosmo.lives--;\r\n            // if (entity.stateCosmo.lives > 0) {\r\n            //     entity.pos.y = 100;\r\n            //     entity.pos.x = currentX - 65;\r\n            // }\r\n\r\n            entity.playerController.death(entity, sprites);\r\n\r\n            entity.playerController.time = 60;// here must be variable !!!\r\n\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Falling.js","import {Trait} from '../Entity';\r\n\r\nexport default class StateCosmo extends Trait {\r\n    constructor() {\r\n        super('stateCosmo');\r\n        this.lives = 3;\r\n        this.coins = 0;\r\n        this.keys = 0;\r\n        this.locks = 0;\r\n        this.opebedLocks = 0;\r\n        this.alive = true;\r\n    }\r\n\r\n    update(entity, deltaTime, sprites) {\r\n\r\n        if (this.lives === 0) {\r\n            this.alive = false;\r\n        }\r\n\r\n        if (this.coins > 100) {\r\n            this.coins = 0;\r\n            this.lives++;\r\n        }\r\n\r\n\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/StateCosmo.js","import Entity, {Sides, Trait} from '../Entity';\r\nimport Jump from '../Traits/Jump';\r\nimport Go from '../Traits/Go';\r\nimport Killable from '../Traits/Killable';\r\nimport PendulumWalk from '../Traits/PendulumWalk';\r\nimport Physics from '../Traits/Physics';\r\n\r\nclass Behavior extends Trait{\r\n    constructor() {\r\n        super('behavior');\r\n    }\r\n\r\n    reachEdge(enemy) {\r\n\r\n        console.log(enemy.pendulumWalk.speed);\r\n\r\n    }\r\n\r\n    collides(us, them) {\r\n        if (us.killable.dead) {\r\n            return;\r\n        }\r\n\r\n        if (them.stomper) {\r\n            if (them.vel.y > us.vel.y) {\r\n                us.pendulumWalk.speed = 0;\r\n                us.killable.kill();\r\n                them.stomper.bounce();\r\n            } else {\r\n                them.killable.kill();\r\n            }\r\n        }\r\n    }\r\n\r\n    update(entity, deltaTime, sprites) {\r\n        const sequence = Math.floor(entity.lifetime % entity.pictures.length);\r\n        entity.picture = entity.pictures[sequence];\r\n    }\r\n}\r\n\r\nexport function createEnemiesFactory(sprites) {\r\n\r\n    return function createEnemy(name, posX, posY,\r\n                                      offsetX, offsetY,\r\n                                      sizeX, sizeY,\r\n                                      velX, velY,\r\n                                      reverse, pictures, deadPic) {\r\n\r\n        const enemy = new Entity(name);\r\n        enemy.size.set(sizeX, sizeY);\r\n        enemy.pos.set(posX * 37, posY * 37);\r\n        enemy.startPositin.set(posX * 37, posY * 37);\r\n        enemy.vel.set(velX, velY);\r\n        enemy.offset.set(offsetX, offsetY);\r\n        enemy.pictures = reverse ? Array.from(pictures).reverse() : pictures;\r\n        enemy.picture = null;\r\n        enemy.deadPic = deadPic;\r\n\r\n        enemy.addTrait(new Physics());\r\n        enemy.addTrait(new PendulumWalk(reverse));\r\n        enemy.addTrait(new Behavior());\r\n        enemy.addTrait(new Killable());\r\n\r\n        sprites.entities.add(enemy);\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Entities/Enemies.js","import {Sides, Trait} from '../Entity.js';\r\n\r\nexport default class PendulumWalk extends Trait {\r\n    constructor(reverse) {\r\n        super('pendulumWalk');\r\n        this.speed = reverse ? 30 : -30;\r\n        let randomForPatrol = Math.random() < 0.5 ? 0.5 : Math.random(); \r\n        this.amplitudePatrol = randomForPatrol * 1000;\r\n    }\r\n\r\n    obstruct(entity, side) {\r\n        if (side === Sides.LEFT || side === Sides.RIGHT) {\r\n            this.speed = -this.speed;\r\n        }\r\n    }\r\n\r\n    update(entity, deltaTime) {\r\n        entity.vel.x = this.speed;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/PendulumWalk.js","import Entity, {Sides, Trait} from '../Entity';\r\nimport Killable from '../Traits/Killable';\r\n\r\nclass Behavior extends Trait{\r\n    constructor() {\r\n        super('behavior');\r\n    }\r\n\r\n    collides(us, them) {\r\n        if (us.killable.dead) {\r\n            return;\r\n        }\r\n\r\n        if (them.stomper) {\r\n            us.killable.removeAfter = 0;\r\n            \r\n            if (us.name.includes('coin')) {\r\n                us.killable.kill();\r\n                them.stateCosmo.coins++;\r\n            } else if (us.name.includes('key')) {\r\n                us.killable.kill();\r\n                them.stateCosmo.keys++;\r\n            } else if (us.name.includes('lock')) {\r\n                if (them.stateCosmo.keys) {\r\n                    us.killable.kill();\r\n                    console.log('congratulation - next level');\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n}\r\n\r\nexport function createArtefactsFactory(sprites) {\r\n\r\n    return function createArtefact(name, posX, posY) {\r\n\r\n        const artefact = new Entity(name);\r\n        artefact.size.set(23, 23);               //!!! resolve\r\n        artefact.pos.set(posX * 37, posY * 37);  //!!! resolve\r\n        artefact.offset.set(7, 7);\r\n        artefact.picture = name;\r\n\r\n        artefact.addTrait(new Killable());\r\n        artefact.addTrait(new Behavior());\r\n        sprites.entities.add(artefact);\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Entities/Artefacts.js","import {Trait} from '../Entity';\r\nimport {Vect} from '../math';\r\n\r\nexport default class PlayerController extends Trait {\r\n    constructor(entity) {\r\n        super('playerController');\r\n\r\n        this.player = entity;\r\n        this.checkPoint = new Vect(0, 0);\r\n\r\n        this.time = 60;\r\n        this.stopTime = false;\r\n    }\r\n\r\n    death(entity, sprites) {\r\n        console.log(56465);\r\n        this.player.stateCosmo.lives--;\r\n        this.time = 60;                //  here must variable of timer\r\n        \r\n        if (this.player.stateCosmo.lives > 0) {\r\n            this.player.killable.revive();\r\n            this.player.pos.set(this.checkPoint.x, this.checkPoint.y);\r\n            sprites.entities.add(this.player);\r\n        }\r\n    }\r\n\r\n    update(entity, deltaTime, sprites) {\r\n        if (!sprites.entities.has(entity) && entity.stateCosmo.alive) {\r\n            this.death(entity,sprites);\r\n        } else if (!this.stopTime){\r\n            this.time -= deltaTime;\r\n        }\r\n\r\n        if (this.time <= 0) {\r\n            this.death(this.player, sprites);\r\n            // this.time = 60;\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/PlayerController.js","import KeyboardListener from './keyboardState';\r\n\r\nexport default function setupKeyboard(cosmo) {\r\n    const input = new KeyboardListener();\r\n\r\n    input.addMapping('Space', keyState => {\r\n        if (keyState) {\r\n            cosmo.jump.start();\r\n        } else {\r\n            cosmo.jump.cancel();\r\n        }\r\n    });\r\n\r\n    input.addMapping('KeyO', keyState => {\r\n        cosmo.slowAndTurbo(keyState);\r\n    });\r\n    input.addMapping('KeyP', keyState => {\r\n        cosmo.turboAndSlow(keyState);\r\n    });\r\n\r\n    input.addMapping('ArrowRight', keyState => {\r\n        cosmo.go.dir += keyState ? 1 : -1;\r\n    });\r\n\r\n    input.addMapping('ArrowLeft', keyState => {\r\n        cosmo.go.dir += keyState ? -1 : 1;\r\n    });\r\n\r\n    return input;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/input.js","const PRESSED = 1;\r\nconst RELEASED = 0;\r\n\r\nexport default class KeyboardState {\r\n    constructor() {\r\n        this.keyStates = new Map();\r\n        this.keyMap = new Map();\r\n    }\r\n    addMapping(code, callback) {\r\n        this.keyMap.set(code, callback);\r\n    }\r\n    handleEvent(event){\r\n        const {code} = event;\r\n\r\n        if(!this.keyMap.has(code)) {\r\n            return;\r\n        }\r\n\r\n        event.preventDefault();\r\n\r\n        const keyState = event.type === 'keydown' ? PRESSED : RELEASED;\r\n\r\n        if (this.keyStates.get(code) === keyState) {\r\n            return;\r\n        }\r\n\r\n        this.keyStates.set(code, keyState);\r\n\r\n        this.keyMap.get(code)(keyState);\r\n    }\r\n\r\n    listenTo(window) {\r\n        ['keydown', 'keyup'].forEach(eventName => {\r\n            window.addEventListener(eventName, event => {\r\n                this.handleEvent(event)\r\n            });\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/keyboardState.js","export function setupMouseControl(canvas, entity, camera) {\r\n    let lastEvent;\r\n\r\n    ['mousedown', 'mousemove'].forEach(eventName => {\r\n        canvas.addEventListener(eventName, event => {\r\n            if (event.buttons === 1) {\r\n                entity.vel.set(0, 0);\r\n                entity.pos.set(event.offsetX + camera.pos.x,\r\n                               event.offsetY + camera.pos.y);\r\n            }\r\n        })\r\n    });\r\n\r\n    window.addEventListener('keydown', event => {\r\n        // console.log(event.code);\r\n        if (event.code === 'KeyD') {\r\n            camera.pos.x += 75;\r\n        }\r\n        if (event.code === 'KeyA') {\r\n            camera.pos.x -= 75;\r\n        }\r\n    });\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/debug.js","export default class Timer {\r\n    constructor(deltaTime = 1/60) {\r\n        let lastTime = 0;\r\n        let accumulatedTime = 0;\r\n\r\n        this.updateProxy = (time) => {\r\n            accumulatedTime += (time - lastTime) / 1000;\r\n\r\n            while (accumulatedTime > deltaTime) {\r\n                this.update(deltaTime);\r\n                accumulatedTime -= deltaTime;\r\n            }\r\n\r\n            lastTime = time;\r\n            this.enqueue();\r\n        }\r\n    }\r\n\r\n    enqueue() {\r\n        requestAnimationFrame(this.updateProxy);\r\n    }\r\n\r\n    start() {\r\n        this.enqueue();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/timer.js","function drawEntityBox(entities) {\r\n    return function drawBoundingBoxes(context, camera) {\r\n        context.strokeStyle = 'red';\r\n        entities.forEach(entity => {\r\n            context.beginPath();\r\n            context.rect(entity.bounds.left - camera.pos.x,\r\n                         entity.bounds.top - camera.pos.y,\r\n                         entity.size.x, entity.size.y);\r\n            context.stroke();\r\n        });\r\n    }\r\n}\r\n\r\nfunction createTileCandidateLayer(tileCollider) {\r\n    const resolvedTiles = [];\r\n\r\n    const tileResolver = tileCollider.tiles;\r\n    const tileSize = tileResolver.tileSize\r\n\r\n    const getByIndexOriginal = tileResolver.getByIndex;\r\n\r\n    tileResolver.getByIndex = function getByIndexFake(x, y) {\r\n        resolvedTiles.push({x,y});\r\n        return getByIndexOriginal.call(tileResolver, x, y);\r\n    }\r\n\r\n    return function drawTileCandidates(context, camera) {\r\n        context.strokeStyle = 'blue';\r\n        resolvedTiles.forEach(({x,y}) => {\r\n            context.beginPath();\r\n            context.rect(x * tileSize - camera.pos.x,\r\n                         y * tileSize - camera.pos.y,\r\n                         tileSize, tileSize);\r\n            context.stroke();\r\n        });\r\n\r\n        resolvedTiles.length = 0;\r\n    }\r\n}\r\n\r\nexport default function createCollisionLayer(sprites) {\r\n\r\n    const drawTileCandidates = createTileCandidateLayer(sprites.tileCollider);\r\n    const drawBoundingBoxes = drawEntityBox(sprites.entities);\r\n\r\n    return function drawCollisions(context, camera) {\r\n        drawTileCandidates(context, camera);\r\n        drawBoundingBoxes(context, camera);\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/layers/collision.js","export default function drawBackground(sprites, layout) {\r\n    const buffer = document.createElement('canvas');\r\n    const bufferContext = buffer.getContext('2d');\r\n\r\n    const width = 37 * 100;\r\n    const height = 37 * 17;\r\n    buffer.setAttribute('width', width);\r\n    buffer.setAttribute('height', height);\r\n\r\n    layout.backgrounds.forEach( tile => {\r\n        const name = tile.name;\r\n        const type = tile.type;\r\n\r\n        tile.pos.forEach(range => {\r\n            switch(range.length) {\r\n                case 4: {\r\n                    sprites.drawTiles(name, bufferContext, type, ...range);\r\n                    break;\r\n                }\r\n                case 3: {\r\n                    let [x, xLen, y] = range;\r\n                    xLen += x;\r\n                    sprites.drawTiles(name, bufferContext, type, x, xLen, y, (y + 1));\r\n                    break;\r\n                }\r\n                case 2: {\r\n                    const [x, y] = range;\r\n                    sprites.drawTiles(name, bufferContext, type, x, (x + 1), y, (y + 1));\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n\r\n    });\r\n\r\n    return function drawBackgroundLayer(context) {\r\n        context.drawImage(buffer, 0 + sprites.camera.pos.x,\r\n                                  0 + sprites.camera.pos.y,\r\n                                  960, 629,\r\n                                  0,\r\n                                  0,\r\n                                  960, 629);\r\n        // context.drawImage(buffer, 0 - sprites.camera.pos.x,\r\n        //                           0 - sprites.camera.pos.y);\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/layers/background.js","export default function createCameraLayer(cameraToDraw) {\r\n    return function drawCameraRect(context, fromCamera) {\r\n        context.strokeStyle = 'purple';\r\n        context.beginPath();\r\n        context.rect(cameraToDraw.pos.x - fromCamera.pos.x,\r\n                     cameraToDraw.pos.y - fromCamera.pos.y,\r\n                     cameraToDraw.size.x, cameraToDraw.size.y);\r\n        context.stroke();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/layers/camera.js","export default function createDashboardLayer(entity) {\r\n    return function drawDashboard(context) {\r\n\r\n        const time = Math.round(entity.playerController.time);\r\n\r\n    \tcontext.font = \"22px Verdana\";\r\n\r\n        context.fillStyle = \"darkViolet\";\r\n        context.fillText(`LEVEL : 1`, 20, 22);\r\n        context.fillText(`COINS : ${entity.stateCosmo.coins}`, 160, 22);\r\n        context.fillText(`LIVES : ${entity.stateCosmo.lives}`, 300, 22);\r\n\r\n        context.fillText(`KEYS : ${entity.stateCosmo.keys}`, 460, 22);\r\n\r\n        context.fillText(`TIME : ${time}`, 840, 22);\r\n\r\n\r\n\r\n        if (!entity.stateCosmo.alive)  {\r\n        \tcontext.font = \"50px Verdana\";\r\n    \t\tcontext.strokeStyle = \"red\";\r\n    \t\tcontext.strokeText(`GAME OVER`, 350, 350);\r\n\r\n            entity.playerController.time = 60;\r\n            entity.playerController.stopTime = true;\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/layers/dashboard.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./style/css/style.css\n// module id = 37\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./style/scss/style.scss\n// module id = 38\n// module chunks = 0"],"sourceRoot":""}