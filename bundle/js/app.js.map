{"version":3,"sources":["webpack:///webpack/bootstrap fb7d37c8ddc43ba7cce5","webpack:///./src/Entity.js","webpack:///./src/math.js","webpack:///./src/Traits/Killable.js","webpack:///./src/createPlayerEnvironment.js","webpack:///./src/Traits/Jump.js","webpack:///./src/Traits/Go.js","webpack:///./src/Traits/Physics.js","webpack:///./src/loaders.js","webpack:///./src/spritesheet.js","webpack:///./src/drawInfo.js","webpack:///./src/app.js","webpack:///./src/game-field.js","webpack:///./src/timer.js","webpack:///./src/layers/collision.js","webpack:///./src/layers/camera.js","webpack:///./src/Entities/Cosmo.js","webpack:///./src/BoundingBox.js","webpack:///./src/Traits/Stomper.js","webpack:///./src/Traits/Falling.js","webpack:///./src/Traits/StateCosmo.js","webpack:///./src/Traits/Dashboard.js","webpack:///./src/Traits/PlayerController.js","webpack:///./src/input.js","webpack:///./src/keyboardState.js","webpack:///./src/debug.js","webpack:///./src/Sprite.js","webpack:///./src/TileCollider.js","webpack:///./src/TileResolver.js","webpack:///./src/EntityCollider.js","webpack:///./src/animations.js","webpack:///./src/Camera.js","webpack:///./src/Sounds.js","webpack:///./src/layers/background.js","webpack:///./src/createEntities.js","webpack:///./src/Entities/Enemies.js","webpack:///./src/Traits/PendulumWalk.js","webpack:///./src/Entities/Artefacts.js","webpack:///./src/Font.js","webpack:///./style/css/style.css","webpack:///./style/scss/style.scss"],"names":["Sides","TOP","Symbol","BOTTOM","LEFT","RIGHT","Trait","constructor","name","NAME","obstruct","collides","us","them","update","Entity","pos","vel","size","offset","startPosition","lifetime","bounds","traits","player","sounds","addTrait","trait","push","side","forEach","candidate","deltaTime","sprites","context","Matrix","grid","get","x","y","col","undefined","set","value","Vect","Killable","dead","deadTime","removeAfter","kill","revive","entity","pictures","deadPic","entities","delete","createCosmo","createCosmoFactory","cosmo","createPlayerEnv","input","setupKeyboard","listenTo","window","playerEntity","playerControl","checkPoint","Jump","duration","velocity","engageTime","ready","requestTime","gracePeriod","speedBoost","start","cancel","Math","abs","Go","dir","speed","acceleration","deceleration","dragFactor","distance","heading","maxSpeed","absX","decel","min","drag","Physics","countPatrol","includes","distanceAll","pendulumWalk","deltaDistance","amplitudePatrol","positionBySinusoid","sin","PI","killable","tileCollider","checkX","camera","checkY","gravity","loadImage","url","Promise","resolve","image","Image","addEventListener","src","loadJSON","fetch","then","response","json","Spritesheet","data","tiles","Map","TILE_SIZE","define","buffers","map","flip","buffer","document","createElement","getContext","png","frame","width","height","scale","translate","deltaX","deltaY","drawImage","drawTiles","type","x1","x2","y1","y2","draw","getEntitiesByName","showGameOver","font","strokeStyle","strokeText","showCongratulations","fillStyle","fillText","drawStartMenu","print","canvas","getElementById","setAttribute","game","all","tileImage","tileData","fontData","fontImage","sprite","createLevelCompositor","letter","event","key","removeEventListener","drawField","timer","restart","bind","e","level","Timer","lastTime","accumulatedTime","updateProxy","time","enqueue","requestAnimationFrame","drawEntityBox","drawBoundingBoxes","beginPath","rect","left","top","stroke","createTileCandidateLayer","resolvedTiles","tileResolver","tileSize","getByIndexOriginal","getByIndex","getByIndexFake","call","drawTileCandidates","length","createCollisionLayer","drawCollisions","createCameraLayer","cameraToDraw","drawCameraRect","fromCamera","SLOW_DRAG","FAST_DRAG","setTurboState","turtleOn","go","setTurtleState","turboOn","add","turboAndSlow","slowAndTurbo","BoundingBox","overlaps","box","bottom","right","Stomper","queueBounce","bounceSpeed","bounce","Falling","stateCosmo","alive","playerController","death","playSound","StateCosmo","lives","coins","keys","locks","Dashboard","round","TIME_LIMIT","PlayerController","stopTime","gameOver","updateTimer","has","addMapping","keyState","jump","PRESSED","RELEASED","KeyboardState","keyStates","keyMap","code","callback","handleEvent","preventDefault","eventName","setupMouseControl","lastEvent","buttons","offsetX","offsetY","Sprite","Set","tilesMatrix","entityCollider","drawEntity","drawCosmo","frames","runAnim","createAnimation","routeFrame","result","layout","createEntities","createPlayerEnvironment","drawLevel","drawBackground","catch","console","log","max","picture","check","TileCollider","tileLayout","matrix","matches","searchByRange","match","reachEdge","stepToEdge","nextTile","TileResolver","toIndex","floor","toIndexRange","pos1","pos2","pMax","ceil","range","indexX","indexY","tile","searchByPosition","posX","posY","EntityCollider","frameLen","resolveFrame","frameIndex","frameName","Camera","Sounds","loadedSounds","loas","play","sound","Audio","load","bufferContext","backgrounds","xLen","drawBackgroundLayer","createEnemy","createEnemiesFactory","createArtefact","createArtefactsFactory","species","sizeX","sizeY","velX","velY","positions","reverse","artefacts","artef","arrPositions","Behavior","enemy","stomper","sequence","Array","from","PendulumWalk","randomForPatrol","random","artefact","Font","text","index"],"mappings":"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","file":"bundle/js/app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap fb7d37c8ddc43ba7cce5","import {Vect} from './math';\r\nimport BoundingBox from './BoundingBox.js';\r\n\r\n\r\nexport const Sides = {\r\n        TOP: Symbol('top'),\r\n        BOTTOM: Symbol('bottom'),\r\n        LEFT: Symbol('left'),\r\n        RIGHT: Symbol('right'),\r\n    };\r\n\r\nexport class Trait {\r\n    constructor(name) {\r\n        this.NAME = name;\r\n    }\r\n\r\n    obstruct() {\r\n\r\n    }\r\n\r\n    collides(us, them) {\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n    }\r\n}\r\n\r\nexport default class Entity {\r\n    constructor(name) {\r\n        this.name = name;\r\n        this.pos = new Vect(0,0);\r\n        this.vel = new Vect(0,0);\r\n        this.size = new Vect(0,0);\r\n        this.offset = new Vect(0,0);\r\n        this.startPosition = new Vect(0,0);\r\n\r\n        this.lifetime = 0;\r\n        this.bounds = new BoundingBox(this.pos, this.size, this.offset);\r\n\r\n        this.traits = [];\r\n\r\n        this.player = false;\r\n\r\n        this.sounds;\r\n    }\r\n\r\n    addTrait(trait) {\r\n        this.traits.push(trait);\r\n        this[trait.NAME] = trait;\r\n    }\r\n\r\n    obstruct(side) {\r\n        this.traits.forEach( trait => {\r\n            trait.obstruct(this, side);\r\n        });\r\n    }\r\n\r\n    collides(candidate) {\r\n        this.traits.forEach( trait => {\r\n            trait.collides(this, candidate);\r\n        });\r\n    }\r\n\r\n    update(deltaTime, sprites, context) {\r\n        this.traits.forEach( trait => {\r\n            trait.update(this, deltaTime, sprites, context);\r\n        })\r\n\r\n        this.lifetime += deltaTime;\r\n\r\n        this.sounds = sprites.sounds;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Entity.js","export class Matrix {\r\n    constructor() {\r\n        this.grid = [];\r\n    }\r\n\r\n    get(x,y) {\r\n        const col = this.grid[x];\r\n        if (col) {\r\n            return col[y];\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    set(x, y, value) {\r\n        if (!this.grid[x]) {\r\n            this.grid[x] = [];\r\n        }\r\n\r\n        this.grid[x][y] = value;\r\n    }\r\n}\r\n\r\nexport class Vect {\r\n    constructor(x, y) {\r\n        this.set(x,y);\r\n    }\r\n    set(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/math.js","import {Sides, Trait} from '../Entity';\r\n\r\nexport default class Killable extends Trait {\r\n    constructor() {\r\n        super('killable');\r\n        this.dead = false;\r\n        this.deadTime = 0;\r\n        this.removeAfter = 2;\r\n    }\r\n\r\n    kill(){\r\n        this.dead = true;\r\n    }\r\n\r\n    revive () {\r\n        this.dead = false;\r\n        this.deadTime = 0;\r\n    }\r\n\r\n    update(entity, deltaTime, sprites) {\r\n        if (this.dead) {\r\n            if (!entity.player) {\r\n                entity.pictures = entity.deadPic;\r\n            } else {\r\n                sprites.entities.delete(entity);\r\n            }\r\n\r\n            if (entity.name === 'purple') {\r\n                entity.offset.y = -180;\r\n            } else if (entity.name === 'green') {\r\n                entity.offset.y = -62;\r\n            }\r\n\r\n            this.deadTime += deltaTime;\r\n\r\n            if (this.deadTime > this.removeAfter) {\r\n                sprites.entities.delete(entity);\r\n            }\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Killable.js","import {createCosmoFactory} from './Entities/Cosmo';\r\nimport PlayerController from './Traits/PlayerController';\r\nimport setupKeyboard from './input';\r\nimport {setupMouseControl} from './debug';\r\n\r\nexport default function(sprites) {\r\n    const createCosmo = createCosmoFactory(sprites);\r\n    const cosmo = createCosmo();\r\n\r\n    createPlayerEnv(cosmo);\r\n\r\n    const input = setupKeyboard(cosmo);\r\n    // setupMouseControl(canvas, cosmo, sprites.camera);\r\n    input.listenTo(window);\r\n}\r\n\r\nfunction createPlayerEnv (playerEntity) {\r\n    const playerControl = new PlayerController(playerEntity);\r\n    playerControl.checkPoint.set(42, 42);\r\n    playerEntity.addTrait(playerControl);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/createPlayerEnvironment.js","\r\nimport {Trait, Sides} from '../Entity';\r\n\r\n\r\nexport default class Jump extends Trait {\r\n    constructor() {\r\n        super('jump');\r\n\r\n        this.duration = 0.5;\r\n        this.velocity = 200;\r\n        this.engageTime = 0;\r\n\r\n        this.ready = 1;\r\n        this.requestTime = 0;\r\n        this.gracePeriod = 0.5;\r\n\r\n        this.speedBoost = 0.3;\r\n    }\r\n\r\n    start() {\r\n        this.requestTime = this.gracePeriod;\r\n    }\r\n\r\n    cancel() {\r\n        this.engageTime = 0;\r\n        this.requestTime = 0;\r\n    }\r\n\r\n    obstruct(entity, side) {\r\n\r\n        if (side === Sides.BOTTOM) {\r\n            this.ready = 1;\r\n        } else if (side === Sides.TOP) {\r\n\r\n            this.cancel();\r\n        }\r\n    }\r\n\r\n    update(entity, deltaTime) {\r\n        if (this.requestTime > 0) {\r\n            if (this.ready > 0) {\r\n                this.engageTime = this.duration;\r\n                this.requestTime = 0;\r\n            }\r\n            this.requestTime -= deltaTime;\r\n        }\r\n\r\n\r\n        if (this.engageTime > 0) {\r\n            entity.vel.y = -(this.velocity + Math.abs(entity.vel.x) * this.speedBoost);\r\n            this.engageTime -= deltaTime;\r\n        }\r\n\r\n        this.ready--;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Jump.js","import {Trait} from '../Entity';\r\n\r\nexport default class Go extends Trait {\r\n    constructor() {\r\n        super('go');\r\n        this.dir = 0;\r\n        this.speed = 12000;\r\n\r\n        this.acceleration = 500;\r\n        this.deceleration = 350;\r\n        this.dragFactor = 1/5000;\r\n\r\n        this.distance = 0;\r\n        this.heading = 1;\r\n    }\r\n\r\n    update(entity, deltaTime) {\r\n        const maxSpeed = this.speed * deltaTime * this.dir;\r\n        const absX = Math.abs(entity.vel.x);\r\n\r\n        if (this.dir !== 0) {\r\n                entity.vel.x += this.acceleration * deltaTime * this.dir;\r\n                this.heading = this.dir;\r\n\r\n            } else if (entity.vel.x !== 0) {\r\n                let decel = Math.min(absX, this.deceleration * deltaTime);\r\n                entity.vel.x += entity.vel.x > 0 ? -decel : decel;\r\n            } else {\r\n                this.distance = 0;\r\n            }\r\n\r\n        const drag = this.dragFactor * entity.vel.x * absX;\r\n        entity.vel.x -= drag;\r\n\r\n        this.distance += absX * deltaTime;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Go.js","import {Sides, Trait} from '../Entity.js';\r\n\r\nexport default class Physics extends Trait {\r\n    constructor() {\r\n        super('physics');\r\n\r\n        this.countPatrol = 0;\r\n    }\r\n\r\n    update(entity, deltaTime, sprites) {\r\n\r\n        if (entity.name.includes('black')) {\r\n\r\n            let distanceAll = Math.abs(entity.pendulumWalk.speed) * entity.lifetime;\r\n            let deltaDistance = distanceAll - this.countPatrol * entity.pendulumWalk.amplitudePatrol;\r\n            let positionBySinusoid = 1 - Math.sin(Math.PI * entity.lifetime)/15;\r\n\r\n            if (deltaDistance > entity.pendulumWalk.amplitudePatrol) {\r\n\r\n                this.countPatrol++;\r\n                entity.pendulumWalk.speed = -entity.pendulumWalk.speed;\r\n            }\r\n\r\n            if (!entity.killable.dead) {\r\n                entity.vel.y = 0;\r\n                entity.pos.y = entity.startPosition.y * positionBySinusoid;\r\n            }\r\n        }\r\n\r\n        entity.pos.x += entity.vel.x * deltaTime;\r\n        sprites.tileCollider.checkX(entity, sprites.camera);\r\n\r\n        entity.pos.y += entity.vel.y * deltaTime;\r\n        sprites.tileCollider.checkY(entity, sprites.camera);\r\n\r\n        entity.vel.y += sprites.gravity * deltaTime;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Physics.js","export function loadImage(url) {\r\n    return new Promise( resolve => {\r\n        const image = new Image();\r\n        image.addEventListener('load', () => {\r\n            resolve(image);\r\n        });\r\n        image.src = url;\r\n    })\r\n}\r\n\r\nexport function loadJSON(name) {\r\n    return fetch(`./src/database/${name}.json`)\r\n    .then(response => response.json());\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/loaders.js","import Camera from './Camera';\r\n\r\nexport default class Spritesheet {\r\n    constructor(image, data) {\r\n        this.image = image;\r\n        this.data = data;\r\n        this.tiles = new Map();\r\n\r\n        this.camera = new Camera();\r\n        this.TILE_SIZE = 37;\r\n    }\r\n\r\n    define(name) {\r\n        const buffers = [false, true].map(flip => {\r\n            const buffer = document.createElement('canvas');\r\n            const context = buffer.getContext('2d');\r\n            const png = this.data[`${name}`].frame;\r\n            buffer.width = png['w'];\r\n            buffer.height = png['h'];\r\n\r\n            if (flip) {\r\n                context.scale(-1, 1);\r\n                context.translate(-buffer.width, 0);\r\n            }\r\n\r\n            if (png['w'] < this.TILE_SIZE && png['h'] < this.TILE_SIZE && !name.includes('enemy')) {\r\n                buffer.width = this.TILE_SIZE;\r\n                buffer.height = this.TILE_SIZE;\r\n                let deltaX = (this.TILE_SIZE - png['w'])/2;\r\n                let deltaY = (this.TILE_SIZE - png['h'])/2;\r\n                context.drawImage(this.image, png['x'], png['y'], png['w'], png['h'],\r\n                                               deltaX,  deltaY,   png['w'], png['h']);\r\n            } else {\r\n                context.drawImage(this.image, png['x'], png['y'], png['w'], png['h'],\r\n                                             0,         0,        png['w'], png['h']);\r\n            }\r\n            return buffer;\r\n        });\r\n        this.tiles.set(name, buffers);\r\n    }\r\n\r\n    // draw(name, context, x, y, type, flip) {\r\n    //     const buffer = this.tiles.get(`${name}.png`)[flip ? 1 : 0];\r\n    //     context.drawImage(buffer, x - this.camera.pos.x, y - this.camera.pos.y);\r\n    // }\r\n\r\n    drawTiles(name, context, type, x1, x2, y1, y2) {\r\n        for (let x = x1; x < x2; ++x) {\r\n            for (let y = y1; y < y2; ++y) {\r\n                this.draw(name, context, x, y, type);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    getEntitiesByName(name) {\r\n        let entities = [];\r\n        this.entities.forEach(value => {\r\n            if (value.name == name) {\r\n                entities.push(value);\r\n            }\r\n        });\r\n        return entities;\r\n    }\r\n\r\n    update(deltaTime, context) {\r\n\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/spritesheet.js","\r\nexport function showGameOver(sprites) {\r\n    const buffer = sprites.tiles.get(`bg.png`)[0];\r\n\r\n    return function(context) {\r\n        context.drawImage(buffer, 0, 0, 960, 629);\r\n\r\n        context.font = \"50px Verdana\";\r\n        context.strokeStyle = \"red\";\r\n        context.strokeText(`GAME OVER`, 320, 210);\r\n        context.strokeText(`PRESS RESTART BUTTON`, 170, 310);\r\n        context.strokeText(`Key \"-\"`, 420, 410);\r\n    }\r\n}\r\n\r\nexport function showCongratulations(sprites) {\r\n    const buffer = sprites.tiles.get(`bg.png`)[0];\r\n\r\n    return function(context) {\r\n        context.drawImage(buffer, 0, 0, 960, 629);\r\n\r\n        context.font = \"50px Verdana\";\r\n        context.strokeStyle = \"lightblue\";\r\n        context.strokeText(`CONGRATULATIONS`, 250, 320);\r\n\r\n        context.font = \"italic 25px Helvetica\";\r\n        context.fillStyle = \"darkSlateBlue\";\r\n        context.fillText(`no more levels`, 10, 580);\r\n        context.fillText(`key \"-\" to restart`, 10, 600);\r\n    }\r\n}\r\n\r\nexport function drawStartMenu(context, sprites, font) {\r\n    \r\n    sprites.draw('bg', context, 0, 0);\r\n    font.print('PRESS', context, 150, 50, 60, 60);\r\n    sprites.draw('boy1', context, 80, 210);\r\n    sprites.draw('boy2', context, 120, 210);\r\n    sprites.draw('boy3', context, 160, 210);\r\n    sprites.draw('boy2', context, 200, 210);\r\n    font.print('ENTER', context, 340, 208, 60, 60);\r\n    sprites.draw('boy4', context, 780, 210);\r\n    font.print('TO', context, 150, 350, 60, 60);\r\n    font.print('START', context, 350, 450, 60, 60);\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/drawInfo.js","import drawField from './game-field';\r\nimport {loadImage,loadJSON} from './loaders';\r\nimport Sprite from './Sprite';\r\nimport Font from './Font';\r\nimport {drawStartMenu} from './drawInfo';\r\n\r\nconst canvas = document.getElementById('canvas');\r\nconst context = canvas.getContext('2d');\r\ncanvas.setAttribute('width', 960);\r\ncanvas.setAttribute('height', 629);\r\n\r\nconst game = Promise.all([\r\n    loadImage('./images/sprites.png'),\r\n    loadJSON('./sprites'),\r\n    loadJSON('./alphabet'),\r\n    loadImage('./images/alphabet.png')\r\n])\r\n.then(async ([tileImage, tileData, fontData, fontImage]) => {\r\n\r\n    const sprites = new Sprite(tileImage, tileData);\r\n    for (let sprite in tileData) {\r\n        sprites.define(sprite);\r\n    }\r\n    await sprites.createLevelCompositor();\r\n\r\n    const font = new Font(fontImage, fontData);\r\n    for (let letter in fontData) {\r\n        font.define(letter);\r\n    }\r\n\r\n    drawStartMenu(context, sprites, font);\r\n    window.addEventListener('keypress', start);\r\n\r\n    return [sprites, font];\r\n})\r\n\r\nconst start = (event) => {\r\n    if (event.key === 'Enter') {\r\n        window.removeEventListener('keypress', start);\r\n\r\n        game.then(([sprites, font]) => {\r\n            drawField(context, sprites);\r\n        })\r\n    }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","import Timer from './timer';\r\n\r\nimport createCollisionLayer from './layers/collision';\r\nimport createCameraLayer from './layers/camera';\r\n\r\nimport createPlayerEnvironment from './createPlayerEnvironment';\r\n\r\nexport default function drawField(context, sprites) {\r\n\r\n    // const drawCollisions = createCollisionLayer(sprites);\r\n    // const drawCameraView = createCameraLayer(sprites.camera);\r\n\r\n    const timer = new Timer(1/60);\r\n    timer.update = function update(deltaTime) {\r\n        sprites.update(deltaTime, context);\r\n        // drawCollisions(context, sprites.camera);\r\n        // drawCameraView(context, sprites.camera);\r\n    }\r\n    timer.start();\r\n\r\n    window.addEventListener('keypress', restart.bind(this, sprites));\r\n}\r\n\r\nconst restart = async (sprites, e) => {\r\n    if (e.key === '-') {\r\n        sprites.level = 1;\r\n        await sprites.createLevelCompositor();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/game-field.js","export default class Timer {\r\n    constructor(deltaTime = 1/60) {\r\n        let lastTime = 0;\r\n        let accumulatedTime = 0;\r\n        let start = true;\r\n\r\n        this.updateProxy = (time) => {\r\n            if (start === true) {\r\n                lastTime = time;\r\n                start = false;\r\n            }\r\n\r\n            accumulatedTime += (time - lastTime) / 1000;\r\n\r\n            while (accumulatedTime > deltaTime) {\r\n                this.update(deltaTime);\r\n                accumulatedTime -= deltaTime;\r\n            }\r\n\r\n            lastTime = time;\r\n            this.enqueue();\r\n        }\r\n    }\r\n\r\n    enqueue() {\r\n        requestAnimationFrame(this.updateProxy);\r\n    }\r\n\r\n    start() {\r\n        this.enqueue();;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/timer.js","function drawEntityBox(entities) {\r\n    return function drawBoundingBoxes(context, camera) {\r\n        context.strokeStyle = 'red';\r\n        entities.forEach(entity => {\r\n            context.beginPath();\r\n            context.rect(entity.bounds.left - camera.pos.x,\r\n                         entity.bounds.top - camera.pos.y,\r\n                         entity.size.x, entity.size.y);\r\n            context.stroke();\r\n        });\r\n    }\r\n}\r\n\r\nfunction createTileCandidateLayer(tileCollider) {\r\n    const resolvedTiles = [];\r\n\r\n    const tileResolver = tileCollider.tiles;\r\n    const tileSize = tileResolver.tileSize\r\n\r\n    const getByIndexOriginal = tileResolver.getByIndex;\r\n\r\n    tileResolver.getByIndex = function getByIndexFake(x, y) {\r\n        resolvedTiles.push({x,y});\r\n        return getByIndexOriginal.call(tileResolver, x, y);\r\n    }\r\n\r\n    return function drawTileCandidates(context, camera) {\r\n        context.strokeStyle = 'blue';\r\n        resolvedTiles.forEach(({x,y}) => {\r\n            context.beginPath();\r\n            context.rect(x * tileSize - camera.pos.x,\r\n                         y * tileSize - camera.pos.y,\r\n                         tileSize, tileSize);\r\n            context.stroke();\r\n        });\r\n\r\n        resolvedTiles.length = 0;\r\n    }\r\n}\r\n\r\nexport default function createCollisionLayer(sprites) {\r\n\r\n    const drawTileCandidates = createTileCandidateLayer(sprites.tileCollider);\r\n    const drawBoundingBoxes = drawEntityBox(sprites.entities);\r\n\r\n    return function drawCollisions(context, camera) {\r\n        drawTileCandidates(context, camera);\r\n        drawBoundingBoxes(context, camera);\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/layers/collision.js","export default function createCameraLayer(cameraToDraw) {\r\n    return function drawCameraRect(context, fromCamera) {\r\n        context.strokeStyle = 'purple';\r\n        context.beginPath();\r\n        context.rect(cameraToDraw.pos.x - fromCamera.pos.x,\r\n                     cameraToDraw.pos.y - fromCamera.pos.y,\r\n                     cameraToDraw.size.x, cameraToDraw.size.y);\r\n        context.stroke();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/layers/camera.js","import Entity from '../Entity';\r\n\r\nimport Jump from '../Traits/Jump';\r\nimport Go from '../Traits/Go';\r\nimport Stomper from '../Traits/Stomper';\r\nimport Physics from '../Traits/Physics';\r\nimport Killable from '../Traits/Killable'\r\nimport Falling from '../Traits/Falling';\r\nimport StateCosmo from '../Traits/StateCosmo';\r\nimport Dashboard from '../Traits/Dashboard';\r\n\r\nconst SLOW_DRAG = 1/2000;\r\nconst FAST_DRAG = 1/5000;\r\n\r\nexport function createCosmoFactory(sprites) {\r\n\r\n    function setTurboState(turtleOn) {\r\n      this.go.dragFactor = turtleOn ? SLOW_DRAG : FAST_DRAG;\r\n    }\r\n\r\n    function setTurtleState(turboOn) {\r\n      this.go.dragFactor = turboOn ? FAST_DRAG : SLOW_DRAG;\r\n    }\r\n\r\n    return function createCosmo() {\r\n        const cosmo = new Entity('cosmo');\r\n\r\n        cosmo.player = true;\r\n\r\n        cosmo.size.set(20, 50);\r\n\r\n        cosmo.pos.set(185, 420);\r\n        cosmo.vel.set(0, -600);\r\n        cosmo.offset.set(9, 0);\r\n\r\n        sprites.entities.add(cosmo);\r\n\r\n        cosmo.addTrait(new Physics());\r\n        cosmo.addTrait(new Jump());\r\n        cosmo.addTrait(new Go());\r\n        cosmo.addTrait(new Stomper());\r\n        cosmo.addTrait(new Killable());\r\n        cosmo.addTrait(new Falling());\r\n        cosmo.addTrait(new StateCosmo());\r\n        cosmo.addTrait(new Dashboard());\r\n\r\n\r\n        cosmo.turboAndSlow = setTurboState;\r\n        cosmo.slowAndTurbo = setTurtleState;\r\n\r\n        return cosmo;\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Entities/Cosmo.js","export default class BoundingBox {\r\n    constructor(pos, size, offset) {\r\n        this.pos = pos;\r\n        this.size = size;\r\n        this.offset = offset;\r\n    }\r\n\r\n    overlaps(box) {\r\n        return this.bottom > box.top\r\n            && this.top < box.bottom\r\n            && this.left < box.right\r\n            && this.right > box.left;\r\n    }\r\n\r\n    get bottom() {\r\n        return this.pos.y + this.size.y + this.offset.y;\r\n    }\r\n\r\n    set bottom(y) {\r\n        this.pos.y = y - (this.size.y + this.offset.y);\r\n    }\r\n\r\n    get top() {\r\n        return this.pos.y + this.offset.y;\r\n    }\r\n\r\n    set top(y) {\r\n        this.pos.y = y - this.offset.y;\r\n    }\r\n\r\n    get left() {\r\n        return this.pos.x + this.offset.x;\r\n    }\r\n\r\n    set left(x) {\r\n        this.pos.x = x - this.offset.x;\r\n    }\r\n\r\n    get right() {\r\n        return this.pos.x + this.size.x + this.offset.x;\r\n    }\r\n\r\n    set right(x) {\r\n        this.pos.x = x - (this.size.x + this.offset.x);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/BoundingBox.js","import {Sides, Trait} from '../Entity.js';\r\n\r\nexport default class Stomper extends Trait {\r\n    constructor() {\r\n        super('stomper');\r\n        this.queueBounce = false;\r\n        this.bounceSpeed = 400;\r\n    }\r\n\r\n    bounce() {\r\n        this.queueBounce = true;\r\n    }\r\n\r\n    update(entity) {\r\n        if (this.queueBounce) {\r\n            entity.vel.y = -this.bounceSpeed;\r\n            this.queueBounce = false;\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Stomper.js","import {Trait} from '../Entity';\r\n\r\nexport default class Falling extends Trait {\r\n    constructor() {\r\n        super('falling');\r\n    }\r\n\r\n    update(entity, deltaTime, sprites) {\r\n        if (entity.pos.y > 800 && entity.stateCosmo.alive) {\r\n            entity.playerController.death(entity, sprites);\r\n            entity.sounds.playSound('fallInAbyss');\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Falling.js","import {Trait} from '../Entity';\r\n\r\nexport default class StateCosmo extends Trait {\r\n    constructor() {\r\n        super('stateCosmo');\r\n        this.lives = 3;\r\n        this.coins = 0;\r\n        this.keys = 0;\r\n        this.locks = 0;\r\n        this.alive = true;\r\n    }\r\n\r\n    update(entity, deltaTime, sprites) {\r\n\r\n        if (this.coins > 50) {\r\n            this.coins = 0;\r\n            this.lives++;\r\n        }\r\n\r\n        if (this.locks === 1) {\r\n            this.locks = 0;\r\n            sprites.level++;\r\n            sprites.createLevelCompositor('won');\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/StateCosmo.js","import {Trait} from '../Entity';\r\n\r\nexport default class Dashboard extends Trait {\r\n    constructor() {\r\n        super('dashboard');\r\n    }\r\n\r\n    update(entity, deltaTime, sprites, context) {\r\n        const time = Math.round(entity.playerController.time);\r\n\r\n    \tcontext.font = \"22px Verdana\";\r\n\r\n        context.fillStyle = \"darkViolet\";\r\n        context.fillText(`LEVEL : 1`, 20, 22);\r\n        context.fillText(`COINS : ${entity.stateCosmo.coins}`, 160, 22);\r\n        context.fillText(`LIVES : ${entity.stateCosmo.lives}`, 300, 22);\r\n\r\n        context.fillText(`KEYS : ${entity.stateCosmo.keys}`, 460, 22);\r\n\r\n        context.fillText(`TIME : ${time}`, 840, 22);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/Dashboard.js","import {Trait} from '../Entity';\r\nimport {Vect} from '../math';\r\n\r\nexport const TIME_LIMIT = 60;\r\n\r\nexport default class PlayerController extends Trait {\r\n    constructor(entity) {\r\n        super('playerController');\r\n\r\n        this.player = entity;\r\n        this.checkPoint = new Vect(0, 0);\r\n\r\n        this.time = TIME_LIMIT;\r\n        this.stopTime = false;\r\n    }\r\n\r\n    death(entity, sprites) {\r\n        this.player.stateCosmo.lives--;\r\n\r\n        if (this.player.stateCosmo.alive) {\r\n            this.player.killable.kill();\r\n        }\r\n\r\n        if (this.player.stateCosmo.lives > 0) {\r\n            this.player.killable.revive();\r\n            this.player.pos.set(this.checkPoint.x, this.checkPoint.y);\r\n            sprites.entities.add(this.player);\r\n        } else {\r\n            entity.stateCosmo.alive = false;\r\n            entity.sounds.playSound('gameOver');\r\n            sprites.gameOver();\r\n        }\r\n\r\n        this.updateTimer();\r\n    }\r\n\r\n    updateTimer() {\r\n        this.time = TIME_LIMIT;\r\n    }\r\n\r\n    update(entity, deltaTime, sprites, context) {\r\n        if (!sprites.entities.has(entity) && entity.stateCosmo.alive) {\r\n\r\n            this.death(entity, sprites);\r\n\r\n        } else if (!this.stopTime){\r\n\r\n            this.time -= deltaTime;\r\n        }\r\n\r\n        if (this.time <= 0) {\r\n            this.death(entity, sprites);\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/PlayerController.js","import KeyboardListener from './keyboardState';\r\n\r\nexport default function setupKeyboard(cosmo) {\r\n    const input = new KeyboardListener();\r\n\r\n    input.addMapping('Space', keyState => {\r\n        if (keyState) {\r\n            cosmo.jump.start();\r\n        } else {\r\n            cosmo.jump.cancel();\r\n        }\r\n    });\r\n\r\n    input.addMapping('KeyO', keyState => {\r\n        cosmo.slowAndTurbo(keyState);\r\n    });\r\n    input.addMapping('KeyP', keyState => {\r\n        cosmo.turboAndSlow(keyState);\r\n    });\r\n\r\n    input.addMapping('ArrowRight', keyState => {\r\n        cosmo.go.dir += keyState ? 1 : -1;\r\n    });\r\n\r\n    input.addMapping('ArrowLeft', keyState => {\r\n        cosmo.go.dir += keyState ? -1 : 1;\r\n    });\r\n\r\n    return input;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/input.js","const PRESSED = 1;\r\nconst RELEASED = 0;\r\n\r\nexport default class KeyboardState {\r\n    constructor() {\r\n        this.keyStates = new Map();\r\n        this.keyMap = new Map();\r\n    }\r\n    addMapping(code, callback) {\r\n        this.keyMap.set(code, callback);\r\n    }\r\n    handleEvent(event){\r\n        const {code} = event;\r\n\r\n        if(!this.keyMap.has(code)) {\r\n            return;\r\n        }\r\n\r\n        event.preventDefault();\r\n\r\n        const keyState = event.type === 'keydown' ? PRESSED : RELEASED;\r\n\r\n        if (this.keyStates.get(code) === keyState) {\r\n            return;\r\n        }\r\n\r\n        this.keyStates.set(code, keyState);\r\n\r\n        this.keyMap.get(code)(keyState);\r\n    }\r\n\r\n    listenTo(window) {\r\n        ['keydown', 'keyup'].forEach(eventName => {\r\n            window.addEventListener(eventName, event => {\r\n                this.handleEvent(event)\r\n            });\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/keyboardState.js","export function setupMouseControl(canvas, entity, camera) {\r\n    let lastEvent;\r\n\r\n    ['mousedown', 'mousemove'].forEach(eventName => {\r\n        canvas.addEventListener(eventName, event => {\r\n            if (event.buttons === 1) {\r\n                entity.vel.set(0, 0);\r\n                entity.pos.set(event.offsetX + camera.pos.x,\r\n                               event.offsetY + camera.pos.y);\r\n            }\r\n        })\r\n    });\r\n\r\n    window.addEventListener('keydown', event => {\r\n        // console.log(event.code);\r\n        if (event.code === 'KeyD') {\r\n            camera.pos.x += 75;\r\n        }\r\n        if (event.code === 'KeyA') {\r\n            camera.pos.x -= 75;\r\n        }\r\n    });\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/debug.js","import {Matrix} from './math';\r\nimport TileCollider from './TileCollider';\r\nimport EntityCollider from './EntityCollider';\r\nimport {createAnimation} from './animations';\r\nimport Spritesheet from './spritesheet';\r\nimport Sounds from './Sounds';\r\n\r\nimport drawBackground from './layers/background';\r\nimport {loadJSON} from './loaders';\r\nimport {createEntities} from './createEntities';\r\nimport createPlayerEnvironment from './createPlayerEnvironment';\r\n\r\nimport {showGameOver, showCongratulations} from './drawInfo';\r\n\r\nexport default class Sprite extends Spritesheet {\r\n    constructor(image, data) {\r\n        super(image, data);\r\n\r\n        this.entities = new Set();\r\n        this.tilesMatrix = new Matrix();\r\n        this.sounds = new Sounds();\r\n\r\n        this.tileCollider = new TileCollider(this.tilesMatrix);\r\n        this.entityCollider = new EntityCollider(this.entities);\r\n\r\n        this.gravity = 2000;\r\n        this.level = 1;\r\n    }\r\n\r\n    draw(name, context, x, y, type, flip) {\r\n        const buffer = this.tiles.get(`${name}.png`)[flip ? 1 : 0];\r\n\r\n        if (type) {\r\n            if (type !== 'decor') {\r\n                this.tilesMatrix.set(x, y, {\r\n                    'name': name,\r\n                    'type': type\r\n                });\r\n            }\r\n        if (name.includes('coin') || name.includes('key')) {\r\n                x = x * this.TILE_SIZE;\r\n                y = y * this.TILE_SIZE;\r\n            } else {\r\n                x = x * buffer.width;\r\n                y = y * buffer.height;\r\n            }\r\n        }\r\n\r\n        context.drawImage(buffer, x - this.camera.pos.x, y - this.camera.pos.y);\r\n    }\r\n\r\n    drawEntity (name, context, x, y, flip = false) {\r\n            const buffer = this.tiles.get(`${name}.png`)[flip ? 0 : 1];\r\n            context.drawImage(buffer, x - this.camera.pos.x, y - this.camera.pos.y);\r\n    }\r\n\r\n    drawCosmo(cosmo, context) {\r\n        let buffer;\r\n\r\n        let frames = ['boy4.png', 'boy3.png', 'boy2.png', 'boy1.png'];\r\n\r\n        let runAnim = createAnimation(frames, 5);\r\n\r\n        function routeFrame (cosmo) {\r\n            if (cosmo.jump.ready < 0) {\r\n                return 'boy3.png';\r\n            }\r\n            if (cosmo.go.distance > 0) {\r\n               return runAnim(cosmo.go.distance);\r\n            }\r\n            return 'boy1.png';\r\n        }\r\n\r\n        buffer = this.tiles.get(routeFrame (cosmo))[cosmo.go.heading > 0 ? 0 : 1];\r\n\r\n        context.drawImage(buffer, cosmo.pos.x - this.camera.pos.x,\r\n                                  cosmo.pos.y - this.camera.pos.y);\r\n    }\r\n\r\n    createLevelCompositor(result) {\r\n        return loadJSON(`./levels/1-${this.level}`).then((layout) => {\r\n            this.entities.forEach(entity => {\r\n                if (!result) {\r\n                    this.entities.delete(entity);\r\n                } else {\r\n                    if (!entity.player) {\r\n                        this.entities.delete(entity);\r\n                    } else {\r\n                        entity.pos.set(100, 100);\r\n                    }\r\n                }\r\n            });\r\n            this.tilesMatrix.grid = [];\r\n            this.camera.pos.x = 0;\r\n\r\n            createEntities(this, layout);\r\n            if (!result) {\r\n                createPlayerEnvironment(this);\r\n            }\r\n\r\n            this.drawLevel = drawBackground(this, layout);\r\n        }).catch(e => {\r\n            console.log('Congratulations, no more levels');\r\n            console.log(e);\r\n            this.gameOver('done')\r\n        });\r\n    }\r\n\r\n    gameOver(result) {\r\n        this.entities.forEach(entity => {\r\n            this.entities.delete(entity);\r\n        });\r\n        this.tilesMatrix.grid = [];\r\n        this.camera.pos.x = 0;\r\n\r\n        if (!result) {\r\n            this.drawLevel = showGameOver(this);\r\n        } else {\r\n            this.drawLevel = showCongratulations(this);\r\n        }\r\n\r\n    }\r\n\r\n    update(deltaTime, context) {\r\n        this.drawLevel(context);\r\n        this.entities.forEach(entity => {\r\n            entity.update(deltaTime, this, context);\r\n\r\n            if (entity.name === 'cosmo') {\r\n                this.drawCosmo(entity, context);\r\n                this.camera.pos.x = entity.pos.x > 3040 ? 2740 : Math.max(0, entity.pos.x - 300);\r\n\r\n            } else if (entity.name.includes('key') || entity.name.includes('coin') || entity.name.includes('lock')) {\r\n                this.draw(entity.name, context, entity.pos.x , entity.pos.y )\r\n\r\n            } else if (entity.name !== 'cosmo') {\r\n                this.drawEntity(entity.picture, context, entity.pos.x, entity.pos.y, entity.pendulumWalk.speed > 0 ? 0 : 1);\r\n            }\r\n        });\r\n\r\n        this.entities.forEach(entity => {\r\n            this.entityCollider.check(entity);\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Sprite.js","import TileResolver from './TileResolver';\r\nimport {Sides} from './Entity';\r\n\r\nexport default class TileCollider {\r\n    constructor(tileLayout) {\r\n        this.tiles = new TileResolver(tileLayout);\r\n    }\r\n\r\n    checkX(entity, camera) {\r\n        if (entity.pos.x < 0 ) {\r\n            entity.pos.x = 0;\r\n        }\r\n         if (entity.bounds.right > this.tiles.tileSize * this.tiles.matrix.grid.length) {\r\n            entity.pos.x = this.tiles.tileSize * this.tiles.matrix.grid.length - entity.size.x - entity.offset.x;\r\n            console.log(entity.pos.x);\r\n        }\r\n\r\n        let x;\r\n        if (entity.vel.x > 0) {\r\n            x = entity.bounds.right;\r\n        } else if (entity.vel.x < 0) {\r\n            x = entity.bounds.left;\r\n        } else {\r\n            return;\r\n        }\r\n\r\n        const matches = this.tiles.searchByRange(x, x,\r\n                                                 entity.bounds.top,\r\n                                                 entity.bounds.bottom);\r\n\r\n        matches.forEach( match => {\r\n            if (entity.vel.x > 0) {\r\n                if (entity.bounds.right > match.x1) {\r\n                    entity.bounds.right = match.x1;\r\n                    entity.vel.x = 0;\r\n\r\n                    entity.obstruct(Sides.RIGHT);\r\n                }\r\n            } else if (entity.vel.x < 0) {\r\n                if (entity.bounds.left < match.x2) {\r\n                    entity.bounds.left = match.x2;\r\n                    entity.vel.x = 0;\r\n\r\n                    entity.obstruct(Sides.LEFT);\r\n                }\r\n\r\n            }\r\n        });\r\n    }\r\n\r\n    checkY(entity) {\r\n        let y;\r\n        if (entity.vel.y > 0) {\r\n            y = entity.bounds.bottom;\r\n        } else if (entity.vel.y < 0) {\r\n            y = entity.bounds.top;\r\n        } else {\r\n            return;\r\n        }\r\n\r\n        const matches = this.tiles.searchByRange(entity.bounds.left,\r\n                                                 entity.bounds.right,\r\n                                                 y, y);\r\n\r\n        matches.forEach( match => {\r\n            if (entity.vel.y > 0) {\r\n                if (entity.bounds.bottom > match.y1) {\r\n\r\n                    entity.bounds.bottom = match.y1;\r\n                    entity.vel.y = 0;\r\n\r\n                    this.reachEdge(entity, y);\r\n\r\n                    entity.obstruct(Sides.BOTTOM);\r\n\r\n                }\r\n            } else if (entity.vel.y < 0) {\r\n                if (entity.bounds.top < match.y2) {\r\n                    entity.bounds.top = match.y2;\r\n                    entity.vel.y = 0;\r\n                    entity.obstruct(Sides.TOP);\r\n                }\r\n\r\n            }\r\n        });\r\n    }\r\n\r\n    reachEdge(entity, y) {\r\n        if (!entity.player) {\r\n\r\n            let stepToEdge = entity.size.x * Math.abs(entity.vel.x)/entity.vel.x;\r\n            stepToEdge = stepToEdge ? stepToEdge : 0;\r\n            let nextTile = this.tiles.searchByRange(entity.bounds.left + stepToEdge,\r\n                                                    entity.bounds.right + stepToEdge,\r\n                                                    y, y)[0];\r\n            if (!nextTile) {\r\n                entity.pendulumWalk.speed = -entity.pendulumWalk.speed;\r\n            }\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/TileCollider.js","// World position -> to tile indexes\r\nexport default class TileResolver {\r\n    constructor(matrix, tileSize = 37) {\r\n        this.matrix = matrix;\r\n        this.tileSize = tileSize;\r\n    }\r\n\r\n    toIndex(pos) {\r\n        return Math.floor(pos / this.tileSize);\r\n    }\r\n\r\n    toIndexRange(pos1, pos2) {\r\n        const pMax = Math.ceil(pos2 / this.tileSize) * this.tileSize;\r\n        const range = [];\r\n        let pos = pos1;\r\n        do {\r\n            range.push(this.toIndex(pos));\r\n            pos += this.tileSize;\r\n        } while (pos < pMax);\r\n        return range;\r\n    }\r\n\r\n    getByIndex(indexX, indexY) {\r\n        const tile = this.matrix.get(indexX, indexY);\r\n        if (tile) {\r\n            const x1 = indexX * this.tileSize;\r\n            const x2 = x1 + this.tileSize;\r\n\r\n            const y1 = indexY * this.tileSize;\r\n            const y2 = y1 + this.tileSize;\r\n            return {\r\n                tile,\r\n                x1,\r\n                x2,\r\n                y1,\r\n                y2\r\n            }\r\n        }\r\n    }\r\n\r\n    \r\n\r\n    searchByPosition(posX, posY) {\r\n        return this.getByIndex(\r\n            this.toIndex(posX),\r\n            this.toIndex(posY));\r\n    }\r\n\r\n    searchByRange(x1, x2, y1, y2) {\r\n        const matches = [];\r\n\r\n        this.toIndexRange(x1, x2).forEach(indexX => {\r\n            this.toIndexRange(y1, y2).forEach(indexY => {\r\n                const match = this.getByIndex(indexX, indexY);\r\n                if (match) {\r\n                    matches.push(match);\r\n                }\r\n            });\r\n        });\r\n\r\n        return matches;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/TileResolver.js","export default class EntityCollider {\r\n    constructor(entities) {\r\n        this.entities = entities;\r\n    }\r\n\r\n    check(entity) {\r\n        this.entities.forEach(candidate => {\r\n            if (entity === candidate) {\r\n                return;\r\n            }\r\n\r\n            if (entity.bounds.overlaps(candidate.bounds)){\r\n                entity.collides(candidate);\r\n                candidate.collides(entity);\r\n            }\r\n        })\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/EntityCollider.js","export\tfunction createAnimation(frames, frameLen) {\r\n\t\treturn function resolveFrame(distance) {\r\n\t\t\tlet frameIndex = Math.floor(distance / frameLen % frames.length);\r\n\t\t\tlet frameName = frames[frameIndex];\r\n\t\t\treturn frameName;\r\n\t\t}\r\n\t}\n\n\n// WEBPACK FOOTER //\n// ./src/animations.js","import {Vect} from './math';\r\n\r\nexport default class Camera {\r\n    constructor(){\r\n        this.pos = new Vect(0, 0);\r\n        this.size = new Vect(900, 629)\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Camera.js","\r\n\r\n\r\nexport default class Sounds{ \r\n\tconstructor() {\r\n\t\tthis.loadedSounds = new Map();\r\n\t\tthis.loas = [];\r\n\t}\r\n\r\n\tplaySound(name) {\r\n\r\n\t\tif (this.loadedSounds.has(name)) {\r\n\r\n\t\t\tthis.loadedSounds.get(name).play();\r\n\r\n\t\t} else {\r\n\r\n\t\t\tlet sound = new Audio (`sounds/${name}.mp3`);\r\n\t\t\tsound.load();\r\n\t\t\tsound.play();\r\n\r\n\t\t\tthis.loadedSounds.set(name, sound);\t\r\n\t\t}   \r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/Sounds.js","export default function drawBackground(sprites, layout) {\r\n    const buffer = document.createElement('canvas');\r\n    const bufferContext = buffer.getContext('2d');\r\n\r\n    const width = 37 * 100;\r\n    const height = 37 * 17;\r\n    buffer.setAttribute('width', width);\r\n    buffer.setAttribute('height', height);\r\n\r\n    layout.backgrounds.forEach( tile => {\r\n        const name = tile.name;\r\n        const type = tile.type;\r\n\r\n        tile.pos.forEach(range => {\r\n            switch(range.length) {\r\n                case 4: {\r\n                    sprites.drawTiles(name, bufferContext, type, ...range);\r\n                    break;\r\n                }\r\n                case 3: {\r\n                    let [x, xLen, y] = range;\r\n                    xLen += x;\r\n                    sprites.drawTiles(name, bufferContext, type, x, xLen, y, (y + 1));\r\n                    break;\r\n                }\r\n                case 2: {\r\n                    const [x, y] = range;\r\n                    sprites.drawTiles(name, bufferContext, type, x, (x + 1), y, (y + 1));\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n\r\n    });\r\n\r\n    return function drawBackgroundLayer(context) {\r\n        context.drawImage(buffer, 0 - sprites.camera.pos.x,\r\n                                  0 - sprites.camera.pos.y);\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/layers/background.js","import {createEnemiesFactory} from './Entities/Enemies'\r\nimport {createArtefactsFactory} from './Entities/Artefacts'\r\n\r\nexport function createEntities(sprites, layout) {\r\n\r\n    const createEnemy = createEnemiesFactory(sprites);\r\n    const createArtefact = createArtefactsFactory(sprites);\r\n\r\n    layout.entities.forEach(species => {\r\n        const name = species.name;\r\n        const [sizeX, sizeY] = species.data.size;\r\n        const pictures = species.data.pictures;\r\n        const deadPic = species.data.deadPic;\r\n        const [velX, velY] = species.data.velocity;\r\n\r\n        species.positions.forEach(entity => {\r\n            const [posX, posY, reverse] = entity.pos;\r\n            const [offsetX, offsetY] = entity.offset;\r\n\r\n            createEnemy(name, posX, posY,\r\n                              offsetX, offsetY,\r\n                              sizeX, sizeY,\r\n                              velX, velY,\r\n                              reverse, pictures, deadPic);\r\n        });\r\n    });\r\n\r\n    layout.artefacts.forEach(artef => {\r\n        const name = artef.name;\r\n\r\n        artef.positions.forEach(arrPositions => {\r\n            const [posX, posY] = arrPositions;\r\n\r\n            createArtefact(name, posX, posY);\r\n        });\r\n    });\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/createEntities.js","import Entity, {Sides, Trait} from '../Entity';\r\nimport Jump from '../Traits/Jump';\r\nimport Go from '../Traits/Go';\r\nimport Killable from '../Traits/Killable';\r\nimport PendulumWalk from '../Traits/PendulumWalk';\r\nimport Physics from '../Traits/Physics';\r\n\r\nclass Behavior extends Trait{\r\n    constructor() {\r\n        super('behavior');\r\n    }\r\n\r\n    reachEdge(enemy) {\r\n\r\n    }\r\n\r\n    collides(us, them) {\r\n        if (us.killable.dead) {\r\n            return;\r\n        }\r\n\r\n        if (them.stomper) {\r\n            if (them.vel.y > us.vel.y) {\r\n                us.pendulumWalk.speed = 0;\r\n                us.killable.kill();\r\n                them.stomper.bounce();\r\n                us.sounds.playSound('killEnemy');\r\n\r\n            } else {\r\n                them.killable.kill();\r\n                them.sounds.playSound('killHero'); \r\n            }\r\n        }\r\n    }\r\n\r\n    update(entity, deltaTime, sprites) {\r\n        const sequence = Math.floor(entity.lifetime % entity.pictures.length);\r\n        entity.picture = entity.pictures[sequence];\r\n    }\r\n}\r\n\r\nexport function createEnemiesFactory(sprites) {\r\n\r\n    return function createEnemy(name, posX, posY,\r\n                                      offsetX, offsetY,\r\n                                      sizeX, sizeY,\r\n                                      velX, velY,\r\n                                      reverse, pictures, deadPic) {\r\n\r\n        const enemy = new Entity(name);\r\n        enemy.size.set(sizeX, sizeY);\r\n        enemy.pos.set(posX * 37, posY * 37);\r\n        enemy.startPosition.set(posX * 37, posY * 37);\r\n        enemy.vel.set(velX, velY);\r\n        enemy.offset.set(offsetX, offsetY);\r\n        enemy.pictures = reverse ? Array.from(pictures).reverse() : pictures;\r\n        enemy.picture = null;\r\n        enemy.deadPic = deadPic;\r\n\r\n        enemy.addTrait(new Physics());\r\n        enemy.addTrait(new PendulumWalk(reverse));\r\n        enemy.addTrait(new Behavior());\r\n        enemy.addTrait(new Killable());\r\n\r\n        sprites.entities.add(enemy);\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Entities/Enemies.js","import {Sides, Trait} from '../Entity.js';\r\n\r\nexport default class PendulumWalk extends Trait {\r\n    constructor(reverse) {\r\n        super('pendulumWalk');\r\n        this.speed = reverse ? 30 : -30;\r\n        let randomForPatrol = Math.random() < 0.5 ? 0.5 : Math.random(); \r\n        this.amplitudePatrol = randomForPatrol * 1000;\r\n    }\r\n\r\n    obstruct(entity, side) {\r\n        if (side === Sides.LEFT || side === Sides.RIGHT) {\r\n            this.speed = -this.speed;\r\n        }\r\n    }\r\n\r\n    update(entity, deltaTime) {\r\n        entity.vel.x = this.speed;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Traits/PendulumWalk.js","import Entity, {Sides, Trait} from '../Entity';\r\nimport Killable from '../Traits/Killable';\r\n\r\nclass Behavior extends Trait{\r\n    constructor() {\r\n        super('behavior');\r\n    }\r\n\r\n    collides(us, them) {\r\n        if (us.killable.dead) {\r\n            return;\r\n        }\r\n\r\n        if (them.stomper) {\r\n            us.killable.removeAfter = 0;\r\n\r\n            if (us.name.includes('coin')) {\r\n                us.killable.kill();\r\n                them.stateCosmo.coins++;\r\n                them.sounds.playSound('getCoin');\r\n                them.playerController.time++;\r\n            } else if (us.name.includes('key')) {\r\n                us.killable.kill();\r\n                them.stateCosmo.keys++;\r\n                them.sounds.playSound('getCoin');\r\n            } else if (us.name.includes('lock')) {\r\n                if (them.stateCosmo.keys) {\r\n                    us.killable.kill();\r\n                    them.sounds.playSound('openLocks');\r\n                    them.stateCosmo.locks++;\r\n                    them.stateCosmo.keys--;\r\n                    console.log('congratulation - next level');\r\n                } else {\r\n                    console.log('take a key');\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport function createArtefactsFactory(sprites) {\r\n\r\n    return function createArtefact(name, posX, posY) {\r\n\r\n        const artefact = new Entity(name);\r\n        artefact.size.set(23, 23);               //!!! resolve\r\n        artefact.pos.set(posX * 37, posY * 37);  //!!! resolve\r\n        artefact.offset.set(7, 7);\r\n        artefact.picture = name;\r\n\r\n        artefact.addTrait(new Killable());\r\n        artefact.addTrait(new Behavior());\r\n        sprites.entities.add(artefact);\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Entities/Artefacts.js","import Spritesheet from './spritesheet'\r\n\r\nexport default class Font extends Spritesheet {\r\n    constructor(image,data) {\r\n        super(image, data);\r\n    }\r\n\r\n    print(text, context, x, y, sizeX, sizeY, flip) {\r\n        [...text].forEach( (letter, index) => {\r\n            const buffer = this.tiles.get(`${letter}.png`)[flip ? 1 : 0];\r\n\r\n            context.drawImage(buffer, x + index * sizeX, y, sizeX, sizeY);\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Font.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./style/css/style.css\n// module id = 39\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./style/scss/style.scss\n// module id = 40\n// module chunks = 0"],"sourceRoot":""}